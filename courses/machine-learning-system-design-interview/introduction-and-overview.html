<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Introduction and Overview - Machine Learning System Design Interview</title>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;700&display=swap" rel="stylesheet">
    <style>* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: 'Open Sans', Arial, sans-serif;
    font-size: 16px;
    line-height: 1.6;
    color: #454545;
    max-width: 800px;
    margin: 0 auto;
    padding: 20px;
}

h1 {
    font-size: 2em;
    margin: 1em 0 0.5em 0;
    line-height: 1.2;
}

h2 {
    font-size: 1.5em;
    margin: 1.2em 0 0.6em 0;
    line-height: 1.3;
}

h3 {
    font-size: 1.2em;
    margin: 1em 0 0.5em 0;
    line-height: 1.4;
}

p {
    margin: 0.8em 0;
}

a {
    color: #0077aa;
    text-decoration: none;
}

a:hover {
    text-decoration: underline;
}

ul, ol {
    margin: 0.8em 0;
    padding-left: 2em;
}

li {
    margin: 0.4em 0;
}

code, pre {
    background: #f4f4f4;
    border: 1px solid #ddd;
    border-radius: 3px;
    font-family: 'Courier New', monospace;
    font-size: 0.9em;
}

code {
    padding: 2px 5px;
}

pre {
    padding: 10px;
    overflow-x: auto;
    margin: 1em 0;
}

pre code {
    border: none;
    padding: 0;
}

img {
    max-width: 100%;
    height: auto;
    display: block;
    margin: 1.5em auto;
}

figure {
    margin: 1.5em 0;
    text-align: center;
}

figcaption {
    font-style: italic;
    font-size: 0.9em;
    color: #666;
    margin-top: 0.5em;
}

.chapter-number {
    font-weight: bold;
    color: #0077aa;
}

.nav {
    margin: 2em 0;
    padding: 1em 0;
    border-top: 1px solid #ddd;
    border-bottom: 1px solid #ddd;
}

.nav a {
    margin-right: 1em;
}

.toc {
    list-style: none;
    padding: 0;
}

.toc li {
    margin: 0.8em 0;
}

.course-section {
    margin: 2em 0;
}

.course-title {
    font-size: 1.3em;
    font-weight: bold;
    color: #0077aa;
    margin: 1.5em 0 0.8em 0;
}

.metadata {
    font-size: 0.9em;
    color: #888;
    margin: 2em 0 1em 0;
}

.breadcrumb {
    font-size: 0.9em;
    color: #666;
    margin-bottom: 1em;
}

.breadcrumb a {
    color: #0077aa;
}

@media (max-width: 600px) {
    body {
        padding: 10px;
    }

    h1 {
        font-size: 1.5em;
    }

    h2 {
        font-size: 1.3em;
    }
}</style>
</head>
<body>
    <div class="breadcrumb">
        <a href="../../index.html">Home</a> /
        <a href="../machine-learning-system-design-interview.html">Machine Learning System Design Interview</a> /
        Introduction and Overview
    </div>

    <div class="nav">
        <a href="../machine-learning-system-design-interview.html">← Course Contents</a>
        
        <a href="visual-search-system.html">Next →</a>
    </div>

    <main>
        <h1>
            <span class="chapter-number">01</span> Introduction and Overview
        </h1>

        <div class="metadata">
            <a href="https://bytebytego.com/courses/machine-learning-system-design-interview/introduction-and-overview" target="_blank" rel="noopener">Original source</a>
        </div>

        <article>
            <header><strong class="style_chapter__grtAe">01</strong><h1>Introduction and Overview</h1></header><p>We have written this book because we want to help machine learning (ML) engineers and data scientists to succeed at ML system design interviews. This book can also be helpful for those who want to achieve a high-level conception of how ML is applied in the real world.</p>
<p>Many engineers think of ML algorithms such as logistic regression or neural networks as the entirety of an ML system. However, an ML system in production involves much more than just model development. ML systems are typically complex, consisting of a number of components, including data stacks to manage data, serving infrastructure to make the system available to millions of users, an evaluation pipeline to measure the performance of the proposed system, and monitoring to ensure the model's performance doesn't degrade over time.</p>
<center><figure class="py-1"><div style="display: flex; justify-content: center;"><img alt="Image represents a high-level architecture of a Machine Learning (ML) system, enclosed within a dashed-line box labeled 'ML System'.  The diagram shows several interconnected components.  On the left, we see blocks for 'Data Collection,' 'Data Verification,' 'Feature Extraction,' and 'Monitoring,' representing the data pipeline.  Centrally located is a light-green box labeled 'ML Algorithm,' the core of the system.  Adjacent to it are 'Process Management Tools' and 'Evaluation Pipeline,' responsible for managing the ML workflow and assessing its performance.  To the right, 'Service Infrastructure' represents the underlying computing resources.  Finally, the right-center contains 'Analysis Tools' and 'Machine Resource Management,' which provide insights into the system's performance and manage its computational resources.  'Configuration' is positioned at the top-right, suggesting system-wide settings.  No explicit data flow is shown, but the arrangement implies data flows from 'Data Collection' through 'Data Verification' and 'Feature Extraction' to the 'ML Algorithm,' with results then flowing to 'Evaluation Pipeline' and 'Analysis Tools' for monitoring and analysis.  The entire system relies on the 'Service Infrastructure' and is managed by 'Process Management Tools' and 'Machine Resource Management'." width="560" height="385" decoding="async" data-nimg="1" sizes="(max-width: 840px) min(560px, 100vw), (max-width: 1200px) min(560px, 80vw), min(560px, 80vw)" srcset="https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-01-UH4IDWGU.png&amp;w=640&amp;q=75 640w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-01-UH4IDWGU.png&amp;w=750&amp;q=75 750w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-01-UH4IDWGU.png&amp;w=828&amp;q=75 828w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-01-UH4IDWGU.png&amp;w=1080&amp;q=75 1080w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-01-UH4IDWGU.png&amp;w=1200&amp;q=75 1200w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-01-UH4IDWGU.png&amp;w=1920&amp;q=75 1920w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-01-UH4IDWGU.png&amp;w=2048&amp;q=75 2048w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-01-UH4IDWGU.png&amp;w=3840&amp;q=75 3840w" src="https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-01-UH4IDWGU.png&amp;w=3840&amp;q=75" style="color: transparent;"></div><div style="display: flex; justify-content: center;"><figcaption class="py-1">Figure 1.1 Components of a production-ready ML system</figcaption></div></figure></center>
<p>At an ML system design interview, you are expected to answer open-ended questions. For example, you might be asked to design a movie recommendation system or a video search engine. There is no single correct answer. The interviewer wants to evaluate your thought process, your in-depth understanding of various ML topics, your ability to design an end-to-end system, and your design choices based on the trade-offs of various options.</p>
<p>To succeed in designing complex ML systems, it is very important to follow a framework. Unstructured answers make the flow difficult to follow. In this introduction, we propose a framework that is used throughout this book to tackle questions about ML system design. The framework consists of the following key steps:</p>
<ol>
<li>Clarifying requirements</li>
<li>Framing the problem as an ML task</li>
<li>Data preparation</li>
<li>Model development</li>
<li>Evaluation</li>
<li>Deployment and serving</li>
<li>Monitoring and infrastructure</li>
</ol>
<center><figure class="py-1"><div style="display: flex; justify-content: center;"><img alt="Image represents a flowchart depicting the stages of a machine learning system design.  The process begins with 'Clarifying Requirements,' which feeds into 'Framing the Problem as an ML Task.' This then flows into 'Data Preparation,' the output of which is used in 'Model Development.' The developed model undergoes 'Evaluation,' leading to 'Development and Serving.' Finally, the deployed system enters a 'Monitoring and Infrastructure' phase, suggesting ongoing maintenance and performance tracking.  Each stage is represented by a distinct box, and arrows indicate the sequential flow of information and progress through the design process." loading="lazy" width="821" height="60" decoding="async" data-nimg="1" sizes="(max-width: 840px) min(821px, 100vw), (max-width: 1200px) min(821px, 80vw), min(821px, 80vw)" srcset="https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-02-5AHN2LDX.png&amp;w=640&amp;q=75 640w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-02-5AHN2LDX.png&amp;w=750&amp;q=75 750w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-02-5AHN2LDX.png&amp;w=828&amp;q=75 828w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-02-5AHN2LDX.png&amp;w=1080&amp;q=75 1080w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-02-5AHN2LDX.png&amp;w=1200&amp;q=75 1200w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-02-5AHN2LDX.png&amp;w=1920&amp;q=75 1920w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-02-5AHN2LDX.png&amp;w=2048&amp;q=75 2048w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-02-5AHN2LDX.png&amp;w=3840&amp;q=75 3840w" src="https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-02-5AHN2LDX.png&amp;w=3840&amp;q=75" style="color: transparent;"></div><div style="display: flex; justify-content: center;"><figcaption class="py-1">Figure 1.2: ML system design steps</figcaption></div></figure></center>
<p>Every ML system design interview is different because the problem is open-ended, and there’s no one-size-fits-all way to succeed. The framework is intended to help you structure your thoughts, but there’s no need to follow it strictly. Be flexible. If an interviewer is mainly interested in model development, you should almost always adhere to their focus.</p>
<p>Let’s start by going over each step in the framework.</p>
<h3 id="clarifying-requirements">Clarifying Requirements</h3>
<p>ML system design questions are usually intentionally vague, with the bare minimum of information. For example, an interview question could be: "design an event recommendation system". The first step is to ask clarifying questions. But what kind of questions to ask? Well, we should ask questions to understand the exact requirements. Here is a list of categorized questions to help us get started:</p>
<ul>
<li>
<p><strong>Business objective</strong>. If we are asked to create a system to recommend vacation
rentals, two possible motivations are to increase the number of bookings and increase
the revenue.</p>
</li>
<li>
<p><strong>Features the system needs to support</strong>. What are some of the features that the system is expected to support which could affect our ML system design? For example, let’s assume we’re asked to design a video recommendation system. We might want to know if users can “like” or “dislike” recommended videos, as those interactions could be used to label training data.</p>
</li>
<li>
<p><strong>Data</strong>. What are the data sources? How large is the dataset? Is the data labeled?</p>
</li>
<li>
<p><strong>Constraints</strong>. How much computing power is available? Is it a cloud-based system, or should the system work on a device? Is the model expected to improve automatically over time?</p>
</li>
<li>
<p><strong>Scale of the system</strong>. How many users do we have? How many items, such as videos, are we dealing with? What’s the rate of growth of these metrics?</p>
</li>
<li>
<p><strong>Performance</strong>. How fast must prediction be? Is a real-time solution expected? Does accuracy have more priority or latency?</p>
</li>
</ul>
<p>This list is not exhaustive, but you can use it as a starting point. Remember that other topics, such as privacy and ethics, can also be important. At the end of this step, we’re expected to reach an agreement with the interviewer about the scope and requirements of the system. It’s generally a good idea to write down the list of requirements and constraints we gather. By doing so, we ensure everyone is on the same page.</p>

<h3 id="frame-the-problem-as-an-ml-task">Frame the Problem as an ML Task</h3>
<p>Effective problem framing plays a critical role in solving ML problems. Suppose an interviewer asks you to increase the user engagement of a video streaming platform. Lack
of user engagement is certainly a problem, but it’s not an ML task. So, we should frame
it as an ML task in order to solve it.
In reality, we should first determine whether or not ML is necessary for solving a given
problem. In an ML system design interview, it’s safe to assume that ML is helpful. So,
we can frame the problem as an ML task by doing the following:</p>
<ul>
<li>Defining the ML objective</li>
<li>Specifying the system’s input and output</li>
<li>Choosing the right ML category</li>
</ul>
<h4 id="defining-the-ml-objective">Defining the ML objective</h4>
<p>A business objective can be to increase sales by 20% or to improve user retention. But the objective may not be well defined, and we cannot train a model simply by telling it, “increase sales by 20%”. For an ML system to solve a task, we need to translate the business objective into a well-defined ML objective. A good ML objective is one that ML models can solve. Let’s look at some examples as shown in Table 1.1. In later chapters, we will see more examples.</p>
<div class="table-wrap" style="--table-min-width: 640px;"><table><thead><tr><th style="text-align: left;">Application</th><th style="text-align: left;">Business objective</th><th style="text-align: left;">ML objective</th></tr></thead><tbody><tr><td style="text-align: left;">Event ticket selling app</td><td style="text-align: left;">Increase ticket sales</td><td style="text-align: left;">Maximize the number of event registrations</td></tr><tr><td style="text-align: left;">Video streaming app</td><td style="text-align: left;">Increase user engagement</td><td style="text-align: left;">Maximize the time users spend watching videos</td></tr><tr><td style="text-align: left;">Ad click prediction system</td><td style="text-align: left;">Increase user clicks</td><td style="text-align: left;">Maximize click-through rate</td></tr><tr><td style="text-align: left;">Harmful content detection in a social media platform</td><td style="text-align: left;">Improve the platform's safety</td><td style="text-align: left;">Accurately predict if a given content is harmful</td></tr><tr><td style="text-align: left;">Friend recommendation system</td><td style="text-align: left;">Increase the rate at which users grow their network</td><td style="text-align: left;">Maximize the number of formed connections</td></tr></tbody></table></div>
<p class="tableCaption"><p>Table 1.1: Translate the business objective to an ML objective</p></p>
<h4 id="specifying-the-systems-input-and-output">Specifying the system’s input and output</h4>
<p>Once we decide on the ML objective, we need to define the system’s inputs and outputs. For example, for a harmful content detection system on a social media platform, the input is a post, and the output is whether this post is considered harmful or not.</p>
<center><figure class="py-1"><div style="display: flex; justify-content: center;"><img alt="Image represents a simplified system for detecting harmful content.  At the bottom is a 'Post' represented as a light pink rectangle containing a user icon, a blank text field suggesting user-generated content, and an image placeholder showing a mountain icon.  An arrow points upward from the 'Post' to a light green rectangle labeled 'Harmful content detection system,' indicating that the post is being processed by this system.  Another upward-pointing arrow connects the 'Harmful content detection system' to a gold rectangle labeled 'Probability,' signifying that the system outputs a probability score representing the likelihood of the post containing harmful content.  The flow demonstrates a process where a user's post is analyzed by a harmful content detection system, which then provides a probability score indicating the level of risk associated with the post's content." loading="lazy" width="535" height="440" decoding="async" data-nimg="1" sizes="(max-width: 840px) min(535px, 100vw), (max-width: 1200px) min(535px, 80vw), min(535px, 80vw)" srcset="https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-03-TC7JW75X.png&amp;w=640&amp;q=75 640w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-03-TC7JW75X.png&amp;w=750&amp;q=75 750w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-03-TC7JW75X.png&amp;w=828&amp;q=75 828w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-03-TC7JW75X.png&amp;w=1080&amp;q=75 1080w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-03-TC7JW75X.png&amp;w=1200&amp;q=75 1200w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-03-TC7JW75X.png&amp;w=1920&amp;q=75 1920w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-03-TC7JW75X.png&amp;w=2048&amp;q=75 2048w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-03-TC7JW75X.png&amp;w=3840&amp;q=75 3840w" src="https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-03-TC7JW75X.png&amp;w=3840&amp;q=75" style="color: transparent;"></div><div style="display: flex; justify-content: center;"><figcaption class="py-1">Figure 1.3: Harmful content detection system input-output </figcaption></div></figure></center>
<p>In some cases, the system may consist of more than one ML model. If so, we need to specify the input and output of each ML model. For example, for harmful content detection, we may want to use one model to predict violence and another model to predict nudity. The system depends on these two models to determine if a post is harmful or not.</p>
<p>Another important consideration is that there might be multiple ways to specify each model’s input-output. Figure 1.4 shows an example.</p>
<center><figure class="py-1"><div style="display: flex; justify-content: center;"><img alt="Image represents two scenarios for predicting user event registration probabilities.  Scenario 1 shows a model receiving input from User A and outputting a vector of probabilities (p₁, p₂, p₃...pₙ) representing the likelihood of User A registering for n different events.  These probabilities are fed into a 'Model' box, which processes them.  The arrow direction indicates information flow from User A to the model and then to the probability vector. Scenario 2 depicts a simplified model where User A and Event 4 (represented by a document icon suggesting event-specific features) are inputs to the model. The model outputs a single probability 'p', representing the likelihood of User A registering for Event 4 specifically.  Arrows again show the direction of information flow, from User A and Event 4 to the model, and then to the probability 'p'.  Both scenarios are framed by dashed boxes labeled 'Scenario 1' and 'Scenario 2' respectively, highlighting the distinct approaches to probability prediction." loading="lazy" width="400" height="335" decoding="async" data-nimg="1" sizes="(max-width: 840px) min(400px, 100vw), (max-width: 1200px) min(400px, 80vw), min(400px, 80vw)" srcset="https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-04-P4XMEQFH.png&amp;w=640&amp;q=75 640w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-04-P4XMEQFH.png&amp;w=750&amp;q=75 750w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-04-P4XMEQFH.png&amp;w=828&amp;q=75 828w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-04-P4XMEQFH.png&amp;w=1080&amp;q=75 1080w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-04-P4XMEQFH.png&amp;w=1200&amp;q=75 1200w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-04-P4XMEQFH.png&amp;w=1920&amp;q=75 1920w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-04-P4XMEQFH.png&amp;w=2048&amp;q=75 2048w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-04-P4XMEQFH.png&amp;w=3840&amp;q=75 3840w" src="https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-04-P4XMEQFH.png&amp;w=3840&amp;q=75" style="color: transparent;"></div><div style="display: flex; justify-content: center;"><figcaption class="py-1">Figure 1.4: Different ways to specify the model’s input-output </figcaption></div></figure></center>
<h4 id="choosing-the-right-ml-category">Choosing the right ML category</h4>
<p>There are many different ways to frame a problem as an ML task. Most problems can be framed as one of the ML categories (leaf nodes) shown in Figure 1.5. As most readers are likely already familiar with them, we only provide an outline here.</p>
<center><figure class="py-1"><div style="display: flex; justify-content: center;"><img alt="Image represents a hierarchical tree diagram categorizing machine learning approaches.  The top-level node is 'Machine learning categories,' branching into three main categories: 'Supervised learning,' 'Unsupervised learning,' and 'Reinforcement learning.'  'Supervised learning' further subdivides into 'Classification' and 'Regression.'  'Classification' then branches into 'Binary' and 'Multiclass,' representing the number of output classes. 'Unsupervised learning' branches into 'Clustering,' 'Association,' and 'Dimension reduction.'  All connections are represented by downward-pointing arrows, indicating a hierarchical relationship where higher-level nodes encompass lower-level ones.  No URLs or parameters are present; only textual labels describe each category." loading="lazy" width="786" height="374" decoding="async" data-nimg="1" sizes="(max-width: 840px) min(786px, 100vw), (max-width: 1200px) min(786px, 80vw), min(786px, 80vw)" srcset="https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-05-S66KLI2R.png&amp;w=640&amp;q=75 640w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-05-S66KLI2R.png&amp;w=750&amp;q=75 750w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-05-S66KLI2R.png&amp;w=828&amp;q=75 828w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-05-S66KLI2R.png&amp;w=1080&amp;q=75 1080w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-05-S66KLI2R.png&amp;w=1200&amp;q=75 1200w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-05-S66KLI2R.png&amp;w=1920&amp;q=75 1920w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-05-S66KLI2R.png&amp;w=2048&amp;q=75 2048w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-05-S66KLI2R.png&amp;w=3840&amp;q=75 3840w" src="https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-05-S66KLI2R.png&amp;w=3840&amp;q=75" style="color: transparent;"></div><div style="display: flex; justify-content: center;"><figcaption class="py-1">Figure 1.5: Common ML categories </figcaption></div></figure></center>
<p><strong>Supervised learning.</strong> A supervised learning model learns a task by using a training dataset. In reality, many problems fall into this category, since learning from a labeled dataset usually leads to better results.</p>
<p><strong>Unsupervised learning.</strong> Unsupervised learning models make predictions by processing data that contain no correct answers. The goal of an unsupervised learning model</p>
<p><strong>Reinforcement learning.</strong> In reinforcement learning, a computer agent learns to perform a task through repeated trial-and-error interactions with the environment. For example, robots can be trained to walk around a room using reinforcement learning, and software programs like AlphaGo can compete in the game of Go by using reinforcement learning.</p>
<p>Compared to supervised learning, unsupervised learning and reinforcement learning are less popular in real-world systems, as ML models usually learn a specific task better when training data is available. As a result, the majority of problems we tackle in this book rely on supervised learning. Let’s take a closer look at the different categories of supervised learning.</p>
<p><strong>Classification model.</strong> Classification is the task of predicting a discrete class label; for example, whether an input image should be classified as "dog", "cat", or "rabbit". Classification models can be divided into two groups:</p>
<ul>
<li>
<p><strong>Binary classification</strong> models predict a binary outcome. For example, the model predicts whether an image contains a dog or not</p>
</li>
<li>
<p><strong>Multiclass classification</strong> models classify the input into more than one class. For example, we can classify an image as a dog, cat, or rabbit</p>
</li>
</ul>
<p>In this step, you are expected to choose the correct ML category. Later chapters provide examples of how to choose the right category during an interview.</p>
<h4 id="talking-points">Talking points</h4>
<p>Here are some topics we might want to talk about during an interview:</p>
<ul>
<li>What is a good ML objective? How do different ML objectives compare? What are the pros and cons?</li>
<li>What are the inputs and outputs of the system, given the ML objective?</li>
<li>If more than one model is involved in the ML system, what are the inputs and outputs of each model?</li>
<li>Does the task need to be learned in a supervised or unsupervised way?</li>
<li>Is it better to solve the problem using a regression or classification model? In the case of classification, is it binary or multiclass? In the case of regression, what is the output range?</li>
</ul>
<h3 id="data-preparation">Data Preparation</h3>
<p>ML models learn directly from data, meaning that data with predictive power is essential for training an ML model. This section aims to prepare high-quality inputs for ML models via two essential processes: data engineering and feature engineering. We will cover the important aspects of each process.</p>
<center><figure class="py-1"><div style="display: flex; justify-content: center;"><img alt="Image represents a data processing pipeline for machine learning.  The pipeline begins with three cylindrical database icons labeled 'Data sources,' representing multiple raw data sources.  A unidirectional arrow indicates data flow from these sources into a dashed-line box containing two rectangular blocks. The first block within the dashed box is labeled 'Data engineering,' and the second is labeled 'Feature engineering.'  A unidirectional arrow connects the 'Data engineering' block to the 'Feature engineering' block, showing the sequential processing of data.  Finally, another unidirectional arrow leads from the 'Feature engineering' block to a single cylindrical database icon labeled 'Prepared features,' representing the output of the pipeline—the processed and engineered features ready for use in a machine learning model.  The dashed-line box visually groups the data and feature engineering stages as a single processing unit." loading="lazy" width="567" height="96" decoding="async" data-nimg="1" sizes="(max-width: 840px) min(567px, 100vw), (max-width: 1200px) min(567px, 80vw), min(567px, 80vw)" srcset="https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-06-2HJIKXJW.png&amp;w=640&amp;q=75 640w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-06-2HJIKXJW.png&amp;w=750&amp;q=75 750w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-06-2HJIKXJW.png&amp;w=828&amp;q=75 828w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-06-2HJIKXJW.png&amp;w=1080&amp;q=75 1080w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-06-2HJIKXJW.png&amp;w=1200&amp;q=75 1200w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-06-2HJIKXJW.png&amp;w=1920&amp;q=75 1920w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-06-2HJIKXJW.png&amp;w=2048&amp;q=75 2048w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-06-2HJIKXJW.png&amp;w=3840&amp;q=75 3840w" src="https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-06-2HJIKXJW.png&amp;w=3840&amp;q=75" style="color: transparent;"></div><div style="display: flex; justify-content: center;"><figcaption class="py-1">Figure 1.6: Data preparation process</figcaption></div></figure></center>
<h4 id="data-engineering">Data engineering</h4>
<p>Data engineering is the practice of designing and building pipelines for collecting, storing, retrieving, and processing data. Let's briefly review data engineering fundamentals to understand the core components we may need.</p>
<h4 id="data-sources">Data sources</h4>
<p>An ML system can work with data from many different sources. Knowing the data sources is a good way to answer many context questions, which may include: who collected it? How clean is the data? Can the data source be trusted? Is the data user-generated or system generated?</p>
<h4 id="data-storage">Data storage</h4>
<p>Data storage, also called a database, is a repository for persistently storing and managing collections of data. Different databases are built to satisfy different use cases, so it’s important to understand at a high level how different databases work. You are usually not expected to know database internals during ML system design interviews.</p>
<center><figure class="py-1"><div style="display: flex; justify-content: center;"><img alt="Image represents a comparison of SQL and NoSQL databases, categorized by data model and example database systems.  The image is horizontally divided into two main sections: 'SQL' and 'NoSQL'. The 'SQL' section shows a relational data model depicted as a table, with 'MySQL' and 'PostgreSQL' listed below as examples. The 'NoSQL' section is further subdivided into four data models: 'Key/Value,' 'Column-based,' 'Graph,' and 'Document.'  The 'Key/Value' model is illustrated with three key-value pairs, each showing a rectangular 'Key' connected by an arrow to an oval 'Value.'  'Redis' and 'DynamoDB' are listed as examples. The 'Column-based' model is represented by several vertical bars, with 'Cassandra' and 'HBase' listed below. The 'Graph' model is shown as a network of interconnected nodes, with 'Neo4J' listed as an example. Finally, the 'Document' model is represented by a simple document icon, with 'MongoDB' and 'CouchDB' listed as examples.  Each data model's visual representation is accompanied by a list of specific database systems that exemplify that model." loading="lazy" width="521" height="152" decoding="async" data-nimg="1" sizes="(max-width: 840px) min(521px, 100vw), (max-width: 1200px) min(521px, 80vw), min(521px, 80vw)" srcset="https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-07-IWLEAUDN.png&amp;w=640&amp;q=75 640w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-07-IWLEAUDN.png&amp;w=750&amp;q=75 750w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-07-IWLEAUDN.png&amp;w=828&amp;q=75 828w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-07-IWLEAUDN.png&amp;w=1080&amp;q=75 1080w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-07-IWLEAUDN.png&amp;w=1200&amp;q=75 1200w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-07-IWLEAUDN.png&amp;w=1920&amp;q=75 1920w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-07-IWLEAUDN.png&amp;w=2048&amp;q=75 2048w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-07-IWLEAUDN.png&amp;w=3840&amp;q=75 3840w" src="https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-07-IWLEAUDN.png&amp;w=3840&amp;q=75" style="color: transparent;"></div><div style="display: flex; justify-content: center;"><figcaption class="py-1">Figure 1.7: Different types of databases </figcaption></div></figure></center>
<h5 id="extract-transform-and-load-etl">Extract, transform, and load (ETL)</h5>
<p>ETL consists of three phases:</p>
<ul>
<li><strong>Extract.</strong> This process extracts data from different data sources.</li>
<li><strong>Transform.</strong> In this phase, data is often cleansed, mapped, and transformed into a specific format to meet operational needs.</li>
<li><strong>Load.</strong> The transformed data is loaded into the target destination, which can be a file, a database, or a data warehouse [1].</li>
</ul>
<center><figure class="py-1"><div style="display: flex; justify-content: center;"><img alt="Image represents an ETL (Extract, Transform, Load) process diagram.  The diagram is divided into three main sections: Extract, Transform, and Load. The 'Extract' section, enclosed by a dashed-line rectangle, shows data sources including a 'Database', 'Logs' (represented as a cylinder), and 'Flat files' (represented as a document icon).  Arrows indicate data flows from these sources into the 'Transform' section. The 'Transform' section, also within a dashed-line rectangle, contains a central, stylized sunburst or gear icon, symbolizing the data transformation process.  Data flows from the 'Extract' section into this transformation stage.  Finally, the 'Load' section, similarly enclosed in a dashed-line rectangle, depicts the target destinations for the transformed data: a 'Database', 'Flat files', and a 'Data warehouse' (represented as a cylinder). Arrows show the transformed data flowing from the 'Transform' section into these destinations.  The overall flow is linear, from data extraction to transformation and finally to loading into various target systems." loading="lazy" width="478" height="307" decoding="async" data-nimg="1" sizes="(max-width: 840px) min(478px, 100vw), (max-width: 1200px) min(478px, 80vw), min(478px, 80vw)" srcset="https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-08-YK5FEBTW.png&amp;w=640&amp;q=75 640w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-08-YK5FEBTW.png&amp;w=750&amp;q=75 750w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-08-YK5FEBTW.png&amp;w=828&amp;q=75 828w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-08-YK5FEBTW.png&amp;w=1080&amp;q=75 1080w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-08-YK5FEBTW.png&amp;w=1200&amp;q=75 1200w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-08-YK5FEBTW.png&amp;w=1920&amp;q=75 1920w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-08-YK5FEBTW.png&amp;w=2048&amp;q=75 2048w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-08-YK5FEBTW.png&amp;w=3840&amp;q=75 3840w" src="https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-08-YK5FEBTW.png&amp;w=3840&amp;q=75" style="color: transparent;"></div><div style="display: flex; justify-content: center;"><figcaption class="py-1">Figure 1.8: An overview of the ETL process </figcaption></div></figure></center>
<h5 id="data-types">Data types</h5>
<p>In ML, data types differ from those in programming languages, such as int, float, string, etc. At the high level, data types can be broken down into two types: structured and unstructured data, as shown in Figure 1.9.</p>
<center><figure class="py-1"><div style="display: flex; justify-content: center;"><img alt="Image represents a hierarchical classification of data types in machine learning.  The top-level node is 'Data types in ML,' which branches into two main categories: 'Structured' and 'Unstructured.'  The 'Structured' category further divides into 'Numerical' and 'Categorical.'  'Numerical' data is then subdivided into 'Discrete' and 'Continuous.'  'Categorical' data is split into 'Ordinal' and 'Nominal.'  The 'Unstructured' category encompasses four types: 'Audio,' 'Video,' 'Image,' and 'Text.'  Arrows indicate the hierarchical relationships, showing how each lower-level category is a subtype of the category above it in the tree structure.  The diagram visually organizes the different ways data can be categorized for use in machine learning models, highlighting the distinction between structured and unstructured data and their respective sub-categories." loading="lazy" width="638" height="246" decoding="async" data-nimg="1" sizes="(max-width: 840px) min(638px, 100vw), (max-width: 1200px) min(638px, 80vw), min(638px, 80vw)" srcset="https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-09-SXR2QNOD.png&amp;w=640&amp;q=75 640w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-09-SXR2QNOD.png&amp;w=750&amp;q=75 750w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-09-SXR2QNOD.png&amp;w=828&amp;q=75 828w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-09-SXR2QNOD.png&amp;w=1080&amp;q=75 1080w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-09-SXR2QNOD.png&amp;w=1200&amp;q=75 1200w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-09-SXR2QNOD.png&amp;w=1920&amp;q=75 1920w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-09-SXR2QNOD.png&amp;w=2048&amp;q=75 2048w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-09-SXR2QNOD.png&amp;w=3840&amp;q=75 3840w" src="https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-09-SXR2QNOD.png&amp;w=3840&amp;q=75" style="color: transparent;"></div><div style="display: flex; justify-content: center;"><figcaption class="py-1">Figure 1.9: Data types in ML</figcaption></div></figure></center>
<p>Structured data follows a predefined data schema, whereas unstructured data does not. For example, dates, names, addresses, credit card numbers, and anything that can be represented in a tabular format with rows and columns, can be considered structured data. Unstructured data refers to data with no underlying data schema, such as images, audio files, videos, and text. Table 1.2 summarizes the key differences between structured and unstructured data.</p>
<div class="table-wrap" style="--table-min-width: 400px;"><table><thead><tr><td><strong></strong></td><td><strong>Structured data</strong></td><td><strong>Unstructured Data</strong></td></tr></thead><tbody><tr><td>Characteristics</td><td><div>•Predefined schema</div><div>•Easy to search</div></td><td><div>•No schema</div><div>•Difficult to search</div></td></tr><tr><td>Resides in</td><td><div>•Relational databases</div><div>•Many NoSQL databases can store structured data</div><div>•Data warehouses</div></td><td><div>•NoSQL databases</div><div>•Data lakes</div></td></tr><tr><td>Examples</td><td><div>•Dates</div><div>•Phone numbers</div><div>•Credit card numbers</div><div>•Addresses</div><div>•Names</div></td><td><div>•Text files</div><div>•Audio files</div><div>•Images</div><div>•Videos</div></td></tr></tbody></table></div>
<p class="tableCaption"><p>Table 1.2: Summary of structured and unstructured data</p></p>
<p>As shown in Figure 1.10, ML models perform differently based on the type of data. Understanding and clarifying whether the data is structured or unstructured helps us choose the appropriate ML model during the model development step.</p>
<center><figure class="py-1"><div style="display: flex; justify-content: center;"><img alt="Image represents a Venn diagram illustrating the relationship between different machine learning algorithms and data types.  Two large circles, labeled 'Structured Data' and 'Unstructured Data,' overlap significantly.  Within the 'Structured Data' circle are four rectangular boxes representing algorithms: 'Decision Trees,' 'Linear Models,' 'SVM' (Support Vector Machine), and 'Naive Bayes.'  Within the 'Unstructured Data' circle, there are no specific algorithms listed.  A larger, light-green rectangle labeled 'Deep Learning' is positioned centrally, overlapping both circles, indicating its applicability to both structured and unstructured data.  No explicit information flow is depicted; the diagram simply shows the association between algorithm types and data types, with deep learning bridging the gap between the two." loading="lazy" width="552" height="237" decoding="async" data-nimg="1" sizes="(max-width: 840px) min(552px, 100vw), (max-width: 1200px) min(552px, 80vw), min(552px, 80vw)" srcset="https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-10-Z2ONCJH4.png&amp;w=640&amp;q=75 640w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-10-Z2ONCJH4.png&amp;w=750&amp;q=75 750w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-10-Z2ONCJH4.png&amp;w=828&amp;q=75 828w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-10-Z2ONCJH4.png&amp;w=1080&amp;q=75 1080w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-10-Z2ONCJH4.png&amp;w=1200&amp;q=75 1200w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-10-Z2ONCJH4.png&amp;w=1920&amp;q=75 1920w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-10-Z2ONCJH4.png&amp;w=2048&amp;q=75 2048w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-10-Z2ONCJH4.png&amp;w=3840&amp;q=75 3840w" src="https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-10-Z2ONCJH4.png&amp;w=3840&amp;q=75" style="color: transparent;"></div><div style="display: flex; justify-content: center;"><figcaption class="py-1">Figure 1.10: Models for structured and unstructured data</figcaption></div></figure></center>
<h5 id="numerical-data">Numerical data</h5>
<p>Numerical data are any data points represented by numbers. As shown in Figure 1.9, numerical data is divided into continuous numerical data and discrete numerical data. For example, house prices can be considered as a continuous numerical value since a house price can take any value within a range. In contrast, the number of houses sold in the past year can be considered discrete numerical data, since it takes distinct values only.</p>
<h5 id="categorical-data">Categorical data</h5>
<p>Categorical data refers to data that can be stored and identified based on their assigned names or labels. For example, gender is categorical data since its value is from a limited set of age ranges. Categorical data can be divided into two groups: nominal and ordinal.</p>
<p>Nominal data refers to data with no numerical relationship between its categories. For example, gender is nominal data since there is no relationship between "male" and "female". Ordinal data refers to data with a predetermined or sequential order. For example, rating data which takes three unique values from "not happy", "neutral", and "happy" is an example of ordinal data.</p>
<h4 id="feature-engineering">Feature Engineering</h4>
<p>Feature engineering contains two processes:</p>
<ul>
<li>Using domain knowledge to select and extract predictive features from raw data</li>
<li>Transforming predictive features into a format usable by the model</li>
</ul>
<p>Choosing the appropriate features is one of the most important decisions when developing and training ML models. It’s essential to choose features that bring the most value, and this feature engineering process requires subject matter expertise and is also highly dependent upon the task at hand. To help you master this process, we give many examples throughout this book.</p>
<p>Once the predictive features are chosen, they need to be transformed into suitable formats using feature engineering operations, which we examine next.</p>
<h4 id="feature-engineering-operations">Feature engineering operations</h4>
<p>It’s quite common for some of the selected features to not be in a format the model can use. Feature engineering operations transform the selected features into a format the model can use. Techniques include handling missing values, scaling values that have skewed distributions, and encoding categorical features. The following list is not comprehensive, but it contains some of the most common operations for structured data.</p>
<h5 id="handling-missing-values">Handling missing values</h5>
<p>Data in production often has missing values, which can generally be addressed in two ways: deletion or imputation.</p>
<p><strong>Deletion.</strong> This method removes any records with a missing value in any of the features. Deletion can be divided into row deletion and column deletion. In column deletion, we remove the whole column representing a feature, if the feature has too many missing values. In row deletion, we remove a row representing a data point if the data point has many missing values.</p>
<center><figure class="py-1"><div style="display: flex; justify-content: center;"><img alt="Image represents a data transformation process.  The image shows two tables, labeled 'Data,' side-by-side.  The left table has five columns: 'ID,' 'Feature 1,' 'Feature 2,' 'Feature 3,' and 'Feature 4.' It contains four rows of data, with some entries in the 'Feature 2' column marked as 'N/A.'  The right table also has four rows and is labeled 'Data,' but only contains four columns: 'ID,' 'Feature 1,' 'Feature 3,' and 'Feature 4.'  The 'Feature 2' column is absent.  A directional arrow connects the two tables, indicating a data transformation where the 'Feature 2' column is removed from the left table to produce the right table.  The remaining data in the other columns ('ID,' 'Feature 1,' 'Feature 3,' and 'Feature 4') remains unchanged in its respective rows between the two tables." loading="lazy" width="705" height="139" decoding="async" data-nimg="1" sizes="(max-width: 840px) min(705px, 100vw), (max-width: 1200px) min(705px, 80vw), min(705px, 80vw)" srcset="https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-11-AS3A3DFN.png&amp;w=640&amp;q=75 640w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-11-AS3A3DFN.png&amp;w=750&amp;q=75 750w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-11-AS3A3DFN.png&amp;w=828&amp;q=75 828w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-11-AS3A3DFN.png&amp;w=1080&amp;q=75 1080w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-11-AS3A3DFN.png&amp;w=1200&amp;q=75 1200w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-11-AS3A3DFN.png&amp;w=1920&amp;q=75 1920w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-11-AS3A3DFN.png&amp;w=2048&amp;q=75 2048w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-11-AS3A3DFN.png&amp;w=3840&amp;q=75 3840w" src="https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-11-AS3A3DFN.png&amp;w=3840&amp;q=75" style="color: transparent;"></div><div style="display: flex; justify-content: center;"><figcaption class="py-1">Figure 1.11: Column deletion </figcaption></div></figure></center>
<p>The drawback of deletion is that it reduces the quantity of data the model can potentially use for training. This is not ideal since ML models tend to work better when they are exposed to more data.</p>
<p><strong>Imputation.</strong> Alternatively, we can impute the missing values by filling them with certain values. Some common practices include:</p>
<ul>
<li>Filling in missing values with their defaults</li>
<li>Filling in missing values with the mean, median, or mode (the most common value)</li>
</ul>
<p>The drawback of imputation is it may introduce noise to the data. It’s important to note that no technique is perfect for handling missing values, as each has its trade-offs</p>
<h5 id="feature-scaling">Feature scaling</h5>
<p>Feature scaling refers to the process of scaling features to have a standard range and distribution. Let’s first look at why feature scaling might be needed.</p>
<p>Many ML models struggle to learn a task when the features of the dataset are in different ranges. For example, features such as age and income might have different value ranges. In addition, some models may struggle to learn the task when a feature has a skewed distribution. What are some of the feature scaling techniques? Let’s take a look.</p>
<p><strong>Normalization (min-max scaling).</strong> In this approach, the features are scaled, so all values are within the range <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[0, 1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span> using the following formula:</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>z</mi><mo>=</mo><mfrac><mrow><mi>x</mi><mo>−</mo><msub><mi>x</mi><mi>min</mi><mo>⁡</mo></msub></mrow><mrow><msub><mi>x</mi><mi>max</mi><mo>⁡</mo></msub><mo>−</mo><msub><mi>x</mi><mi>min</mi><mo>⁡</mo></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">z= \frac{x - x_{\min}}{x_{\max} - x_{\min}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal" style="margin-right: 0.04398em;">z</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 2.0963em; vertical-align: -0.836em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.2603em;"><span style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mtight">m</span><span class="mtight">a</span><span class="mtight">x</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3175em;"><span style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mtight">m</span><span class="mtight">i</span><span class="mtight">n</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span></span></span></span></span></span></span></span></span><span style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3175em;"><span style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mtight">m</span><span class="mtight">i</span><span class="mtight">n</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.836em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span>
<p>Note that normalization does not change the distribution of the feature. In order to change the distribution of a feature to follow a standard distribution, standardization is used.</p>
<p><strong>Standardization (Z-score normalization).</strong> Standardization is the process of changing the distribution of a feature to have a <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">0</span></span></span></span> mean and a standard deviation of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">1</span></span></span></span>. The following formula is used to standardize a feature:</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>z</mi><mo>=</mo><mfrac><mrow><mi>x</mi><mo>−</mo></mrow><mi>σ</mi></mfrac></mrow><annotation encoding="application/x-tex">z= \frac{x-}{\sigma}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal" style="margin-right: 0.04398em;">z</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1.9463em; vertical-align: -0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.2603em;"><span style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03588em;">σ</span></span></span><span style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="mord">−</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span>
<p>Where <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>μ</mi></mrow><annotation encoding="application/x-tex">\mu</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.1944em;"></span><span class="mord mathnormal">μ</span></span></span></span> is the feature’s mean and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>σ</mi></mrow><annotation encoding="application/x-tex">\sigma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">σ</span></span></span></span> is the standard deviation.</p>
<p><strong>Log scaling.</strong> To mitigate the skewness of a feature, a common technique called log scaling can be used, with the following formula:</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>z</mi><mo>=</mo><mi>log</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">z= \log(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal" style="margin-right: 0.04398em;">z</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mop">lo<span style="margin-right: 0.01389em;">g</span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span>
<p>Log transformation can make data distribution less skewed, and enable the optimization algorithm to converge faster.</p>
<h5 id="discretization-bucketing">Discretization (Bucketing)</h5>
<p>Discretization is the process of converting a continuous feature into a categorical feature. For example, instead of representing height as a continuous feature, we can divide heights into discrete buckets and represent each height by the bucket to which it belongs. This allows the model to focus on learning only a few categories instead of attempting to learn an infinite number of possibilities.</p>
<center><figure class="py-1"><div style="display: flex; justify-content: center;"><img alt="Image represents a histogram showing the distribution of user heights.  The horizontal axis represents 'User's height,' divided into several bins indicated by vertical red lines.  The vertical axis represents '# of users,' indicating the frequency of users falling within each height bin.  Each bar in the histogram represents a height bin, with its height corresponding to the number of users whose height falls within that range. The bars are light green with black outlines.  The histogram visually displays the frequency distribution of user heights, allowing for a quick assessment of the most common height ranges and the overall distribution's shape.  No specific numerical values for height or user counts are provided on the axes; only the relative frequencies are shown." loading="lazy" width="370" height="353" decoding="async" data-nimg="1" sizes="(max-width: 840px) min(370px, 100vw), (max-width: 1200px) min(370px, 80vw), min(370px, 80vw)" srcset="https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-12-TWA3HA5C.png&amp;w=640&amp;q=75 640w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-12-TWA3HA5C.png&amp;w=750&amp;q=75 750w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-12-TWA3HA5C.png&amp;w=828&amp;q=75 828w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-12-TWA3HA5C.png&amp;w=1080&amp;q=75 1080w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-12-TWA3HA5C.png&amp;w=1200&amp;q=75 1200w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-12-TWA3HA5C.png&amp;w=1920&amp;q=75 1920w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-12-TWA3HA5C.png&amp;w=2048&amp;q=75 2048w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-12-TWA3HA5C.png&amp;w=3840&amp;q=75 3840w" src="https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-12-TWA3HA5C.png&amp;w=3840&amp;q=75" style="color: transparent;"></div><div style="display: flex; justify-content: center;"><figcaption class="py-1">Figure 1.12: Discretizing user’s height into 6 buckets</figcaption></div></figure></center>
<p>Discretization can also be applied to discrete features. For example, a user’s age is a discrete feature, but discretizing it reduces the number of categories, as shown in Table 1.3.</p>
<div class="table-wrap"><table><thead><tr><th style="text-align: center;">Bucket</th><th style="text-align: center;">Age range</th></tr></thead><tbody><tr><td style="text-align: center;">1</td><td style="text-align: center;">0-9</td></tr><tr><td style="text-align: center;">2</td><td style="text-align: center;">10-19</td></tr><tr><td style="text-align: center;">3</td><td style="text-align: center;">20-39</td></tr><tr><td style="text-align: center;">4</td><td style="text-align: center;">40-59</td></tr><tr><td style="text-align: center;">5</td><td style="text-align: center;">60+</td></tr></tbody></table></div>
<p class="tableCaption">Table 1.3: Discretizing numeric age attributes</p>
<h5 id="encoding-categorical-features">Encoding categorical features</h5>
<p>In most ML models, all inputs and outputs must be numerical. This means if a feature is categorical, we should encode it into numbers before sending it to the model. There are three common methods for converting categorical features into numeric representations: integer encoding, one-hot encoding, and embedding learning.</p>
<p><strong>Integer encoding.</strong> An integer value is assigned to each unique category value. For example, “Excellent” is <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">1</span></span></span></span>, “Good” is <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn></mrow><annotation encoding="application/x-tex">2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">2</span></span></span></span>, and “Bad” is <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>3</mn></mrow><annotation encoding="application/x-tex">3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">3</span></span></span></span>. This method is useful if the integer values have a natural relationship with each other.</p>
<center><figure class="py-1"><div style="display: flex; justify-content: center;"><div style="position: relative; width: 300px; height: 102px;"><img alt="Image represents a process of integer encoding for categorical data.  On the left is a table labeled 'Color' containing three rows representing categorical values: 'Excellent,' 'Good,' and 'Bad.'  A thick arrow labeled 'Integer encoding' points from this table to another table on the right labeled 'Integer ID.' This right table contains three rows with corresponding integer values: 1, 2, and 3, respectively.  The arrow indicates that the categorical values ('Excellent,' 'Good,' 'Bad') are being mapped to numerical representations (1, 2, 3) through an integer encoding scheme.  This transformation is a common preprocessing step in machine learning to convert qualitative data into a format suitable for numerical algorithms." loading="lazy" width="300" height="102" decoding="async" data-nimg="1" sizes="(max-width: 840px) min(300px, 100vw), (max-width: 1200px) min(300px, 80vw), min(300px, 80vw)" srcset="https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-13-RCKFD4WR.png&amp;w=640&amp;q=75 640w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-13-RCKFD4WR.png&amp;w=750&amp;q=75 750w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-13-RCKFD4WR.png&amp;w=828&amp;q=75 828w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-13-RCKFD4WR.png&amp;w=1080&amp;q=75 1080w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-13-RCKFD4WR.png&amp;w=1200&amp;q=75 1200w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-13-RCKFD4WR.png&amp;w=1920&amp;q=75 1920w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-13-RCKFD4WR.png&amp;w=2048&amp;q=75 2048w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-13-RCKFD4WR.png&amp;w=3840&amp;q=75 3840w" src="https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-13-RCKFD4WR.png&amp;w=3840&amp;q=75" style="color: transparent;"></div></div><div style="display: flex; justify-content: center;"><figcaption class="py-1">Figure 1.13: Integer encoding</figcaption></div></figure></center>
<p>However, when there is no ordinal relationship between categorical features, integer encoding is not a good choice. One-hot encoding, which we will examine next, addresses this issue.</p>
<p><strong>One-hot encoding.</strong> With this technique, a new binary feature is created for each unique value. As shown in Figure 1.14, we replace the original feature (color) with three new binary features (red, green, and blue). For example, if a data point has a “red” color, we replace it with “<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">1</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">0</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">0</span></span></span></span>”.</p>
<center><figure class="py-1"><div style="display: flex; justify-content: center;"><img alt="Image represents a visual explanation of one-hot encoding.  On the left is a table with a single column labeled 'Color' and three rows listing the colors 'Red,' 'Green,' and 'Blue.' A thick arrow labeled 'One-hot encoding' points from this table to a second table on the right. This right table has three columns, each headed by one of the colors ('Red,' 'Green,' 'Blue'), and three rows. Each row in the right table represents a one-hot encoded vector for a color from the left table.  Specifically, for each color in the left table, the corresponding row in the right table contains a '1' in the column representing that color and '0's in all other columns. This demonstrates how a categorical variable (color) is transformed into a numerical representation suitable for machine learning algorithms." loading="lazy" width="355" height="93" decoding="async" data-nimg="1" sizes="(max-width: 840px) min(355px, 100vw), (max-width: 1200px) min(355px, 80vw), min(355px, 80vw)" srcset="https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-14-DBIGSKQ7.png&amp;w=640&amp;q=75 640w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-14-DBIGSKQ7.png&amp;w=750&amp;q=75 750w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-14-DBIGSKQ7.png&amp;w=828&amp;q=75 828w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-14-DBIGSKQ7.png&amp;w=1080&amp;q=75 1080w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-14-DBIGSKQ7.png&amp;w=1200&amp;q=75 1200w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-14-DBIGSKQ7.png&amp;w=1920&amp;q=75 1920w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-14-DBIGSKQ7.png&amp;w=2048&amp;q=75 2048w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-14-DBIGSKQ7.png&amp;w=3840&amp;q=75 3840w" src="https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-14-DBIGSKQ7.png&amp;w=3840&amp;q=75" style="color: transparent;"></div><div style="display: flex; justify-content: center;"><figcaption class="py-1">Figure 1.14: One-hot encoding</figcaption></div></figure></center>
<p><strong>Embedding learning.</strong> Another way to encode a categorical feature is to use embedding learning. An embedding is a mapping of a categorical feature into an <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.10903em;">N</span></span></span></span>-dimensional vector. Embedding learning is the process of learning an N-dimensional vector for each unique value that the categorical feature may take. This approach is useful when the number of unique values the feature takes is very large. In this case, one-hot encoding is not a good option because it leads to very large vector sizes. We will see more examples in later chapters.</p>
<h4 id="talking-points-1">Talking points</h4>
<p>Here are some topics we might want to discuss during the interview:</p>
<ul>
<li><strong>Data availability and data collection:</strong> What are the data sources? What data is available to us, and how do we collect it? How large is the data size? How often do new data come in?</li>
<li><strong>Data storage:</strong> Where is the data currently stored? Is it on the cloud or on user devices? Which data format is appropriate for storing the data? How do we store multimodal data, e.g., a data point that might contain both images and texts?</li>
<li><strong>Feature engineering:</strong> How do we process raw data into a form that’s useful for the models? What should we do about missing data? Is feature engineering required for
this task? Which operations do we use to transform the raw data into a format usable by the ML model? Do we need to normalize the features? Which features should we construct from the raw data? How do we plan to combine data of different types, such as texts, numbers, and images?</li>
<li><strong>Privacy:</strong> How sensitive are the available data? Are users concerned about the privacy of their data? Is anonymization of user data necessary? Is it possible to store users’ data on our servers, or is it only possible to access their data on their devices?</li>
<li><strong>Biases:</strong> Are there any biases in the data? If yes, what kinds of biases are present, and how do we correct them?</li>
</ul>
<h3 id="model-development">Model Development</h3>
<p>Model development refers to the process of selecting an appropriate ML model and training it to solve the task at hand.</p>
<h4 id="model-selection">Model selection</h4>
<p>Model selection is the process of choosing the best ML algorithm and architecture for a predictive modeling problem. In practice, a typical process for selecting a model is to:</p>
<ul>
<li><strong>Establish a simple baseline.</strong> For example, in a video recommendation system, the baseline can be obtained by recommending the most popular videos.</li>
<li><strong>Experiment with simple models.</strong> After we have a baseline, a good practice is to explore ML algorithms that are quick to train, such as logistic regression.</li>
<li><strong>Switch to more complex models.</strong> If simple models cannot deliver satisfactory results, we can then consider more complex models, such as deep neural networks.</li>
<li><strong>Use an ensemble of models if we want more accurate predictions.</strong> Using an ensemble of multiple models instead of only one may improve the quality of predictions. Creating an ensemble can be accomplished in three ways: bagging [2], boosting [3], and stacking [4], which will be discussed in later chapters.</li>
</ul>
<p>In an interview setting, it’s important to explore various model options and discuss their pros and cons. Some typical model options include:</p>
<ul>
<li>Logistic regression</li>
<li>Linear regression</li>
<li>Decision trees</li>
<li>Gradient boosted decision trees and random forests</li>
<li>Support vector machines</li>
<li>Naive Bayes</li>
<li>Factorization Machines (FM)</li>
<li>Neural networks</li>
</ul>
<p>When examining different options, it’s good to briefly explain the algorithm and discuss the trade-offs. For example, logistic regression may be a good option for learning a linear task, but if the task is complex, we may need to choose a different model. When choosing an ML algorithm, it’s important to consider different aspects of a model. For example:</p>
<ul>
<li>The amount of data the model needs to train on</li>
<li>Training speed</li>
<li>Hyperparameters to choose and hyperparameter tuning techniques</li>
<li>Possibility of continual learning</li>
<li>Compute requirements. A more complex model might deliver higher accuracy, but might require more computing power, such as a GPU instead of a CPU</li>
<li>Model’s interpretability [5]. A more complex model can give better performance, but its results may be less interpretable</li>
</ul>
<p>There is no single best algorithm that solves all problems. The interviewer wants to see if you have a good understanding of different ML algorithms, their pros and cons, and your ability to choose a model based on requirements and constraints. To help you improve model selection, this book contains a variety of model selection examples. This book assumes you are familiar with common ML algorithms. To refresh your memory, read [6].</p>
<h4 id="model-training">Model training</h4>
<p>Once the model selection is complete, it’s time to train the model. During this step, there are various topics you may want to discuss at an interview, such as:</p>
<ul>
<li>Constructing the dataset</li>
<li>Choosing the loss function</li>
<li>Training from scratch vs. fine-tuning</li>
<li>Distributed training</li>
</ul>
<p>Let’s look at each one.</p>
<h5 id="constructing-the-dataset">Constructing the dataset</h5>
<p>At an interview, it’s usually a good idea to talk about constructing the dataset for model training and evaluation. As Figure 1.15 illustrates, there are 5 steps in constructing the dataset.</p>
<center><figure class="py-1"><div style="display: flex; justify-content: center;"><img alt="Image represents a flowchart depicting the initial steps in preparing data for a machine learning model.  The process begins with a box labeled 'Collect the raw data,' which acts as the input.  An arrow points from this box to the next, 'Identify features and labels,' indicating the raw data is processed to distinguish features (input variables) and labels (target variables).  This output then flows to 'Select a sampling strategy,' where a method for handling the data (e.g., oversampling, undersampling) is chosen.  The selected sampling strategy's output is then fed into 'Split the data,' which divides the data into subsets (e.g., training, validation, testing). Finally, an arrow connects 'Split the data' to 'Address class imbalance (if any),' signifying that class imbalance issues within the data subsets are addressed, if present, before proceeding to model training (not shown in the image).  The entire flow is sequential, with each step's output becoming the input for the subsequent step." loading="lazy" width="580" height="60" decoding="async" data-nimg="1" sizes="(max-width: 840px) min(580px, 100vw), (max-width: 1200px) min(580px, 80vw), min(580px, 80vw)" srcset="https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-15-IIAT7EAW.png&amp;w=640&amp;q=75 640w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-15-IIAT7EAW.png&amp;w=750&amp;q=75 750w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-15-IIAT7EAW.png&amp;w=828&amp;q=75 828w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-15-IIAT7EAW.png&amp;w=1080&amp;q=75 1080w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-15-IIAT7EAW.png&amp;w=1200&amp;q=75 1200w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-15-IIAT7EAW.png&amp;w=1920&amp;q=75 1920w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-15-IIAT7EAW.png&amp;w=2048&amp;q=75 2048w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-15-IIAT7EAW.png&amp;w=3840&amp;q=75 3840w" src="https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-15-IIAT7EAW.png&amp;w=3840&amp;q=75" style="color: transparent;"></div><div style="display: flex; justify-content: center;"><figcaption class="py-1">Figure 1.15: Dataset construction steps</figcaption></div></figure></center>
<p>All the steps except “identify features and labels” are generic operations, which can be applied to any ML system design task. In this chapter, we will take a close look at each step, but in later chapters, we will mainly focus on “identify features and labels,” which is task-specific.</p>
<h6 id="collect-the-raw-data">Collect the raw data</h6>
<p>This is extensively discussed in the data preparation step, so we do not repeat it here.</p>
<h6 id="identify-features-and-labels">Identify features and labels</h6>
<p>During the feature engineering step, we have already discussed which features to use. So, let’s focus on creating labels for the data. There are two common ways to get labels: hand labeling and natural labeling.</p>
<p><strong>Hand labeling.</strong> This means individual annotators label the data by hand. For example, an individual annotator labels whether a post contains misinformation or not. Hand labeling leads to accurate labels since a human is involved in the process. However, hand labeling has many drawbacks; it is expensive and slow, introduces bias, requires domain knowledge, and is a threat to data privacy.</p>
<p><strong>Natural labeling.</strong> In natural labeling, the ground truth labels are inferred automatically without human annotations. Let’s see an example to better understand natural labels.</p>
<p>Suppose we want to design an ML system that ranks news feeds based on relevance. One possible way to solve this task is to train a model which takes a user and a post as input, and outputs the probability that the user will press the ``like” button after seeing this post. In this case, the training data are pairs of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">⟨</mo></mrow><annotation encoding="application/x-tex">\langle</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">⟨</span></span></span></span> user, post <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">⟩</mo></mrow><annotation encoding="application/x-tex">\rangle</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mclose">⟩</span></span></span></span> and their corresponding label, which is 1 if the user liked the post, and 0 if they did not. This way, we are able to naturally label the training data without relying on human annotations.</p>
<p>In this step, it is important to clearly communicate how we obtain training labels and what the training data looks like.</p>
<h6 id="select-a-sampling-strategy">Select a sampling strategy</h6>
<p>It is often impractical to collect all the data, so sampling is an efficient way to reduce the amount of data in the system. Common sampling strategies include convenience sampling, snowball sampling, stratified sampling, reservoir sampling, and importance sampling. To learn more about sampling methods, you can refer to [7].</p>
<h6 id="split-the-data">Split the data</h6>
<p>Data splitting refers to the process of dividing the dataset into training, evaluation (validation), and test dataset. To learn more about data splitting techniques, refer to [8].</p>
<h6 id="address-any-class-imbalances">Address any class imbalances</h6>
<p>A dataset with skewed class labels is called an imbalanced dataset. The class that makes up a larger proportion of the dataset is called the majority class, and the class which comprises a smaller proportion of the dataset is known as the minority class.</p>
<center><figure class="py-1"><div style="display: flex; justify-content: center;"><img alt="Image represents a bar chart illustrating class imbalance in a dataset.  The horizontal axis labels 'Classes,' representing two categories: 'Positive' (minority class) and 'Negative' (majority class). The vertical axis is labeled 'Number of data points,' ranging from 0 to 4000. A light-green bar represents the 'Positive' class, reaching approximately 1000 data points. A light-pink bar represents the 'Negative' class, reaching approximately 3800 data points.  The chart visually demonstrates a significant class imbalance, where the 'Negative' class has considerably more data points than the 'Positive' class.  This imbalance is explicitly noted with the labels '(Minority class)' and '(Majority class)' under each bar." loading="lazy" width="479" height="218" decoding="async" data-nimg="1" sizes="(max-width: 840px) min(479px, 100vw), (max-width: 1200px) min(479px, 80vw), min(479px, 80vw)" srcset="https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-16-4G5WT5LJ.png&amp;w=640&amp;q=75 640w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-16-4G5WT5LJ.png&amp;w=750&amp;q=75 750w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-16-4G5WT5LJ.png&amp;w=828&amp;q=75 828w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-16-4G5WT5LJ.png&amp;w=1080&amp;q=75 1080w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-16-4G5WT5LJ.png&amp;w=1200&amp;q=75 1200w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-16-4G5WT5LJ.png&amp;w=1920&amp;q=75 1920w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-16-4G5WT5LJ.png&amp;w=2048&amp;q=75 2048w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-16-4G5WT5LJ.png&amp;w=3840&amp;q=75 3840w" src="https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-16-4G5WT5LJ.png&amp;w=3840&amp;q=75" style="color: transparent;"></div><div style="display: flex; justify-content: center;"><figcaption class="py-1">Figure 1.16: Imbalanced dataset with two classes</figcaption></div></figure></center>
<p>An imbalanced dataset is a serious issue in model training, as it means a model may not have enough data to learn the minority class. There are different techniques to mitigate this issue. Let’s take a look at two commonly used approaches: resampling training data and altering the loss function.</p>
<h6 id="resampling-training-data">Resampling training data</h6>
<p>Resampling refers to the process of adjusting the ratio between different classes, making the data more balanced. For example, we can oversample the minority class (Figure 1.17) or undersample the majority class (Figure 1.18)</p>
<center><figure class="py-1"><div style="display: flex; justify-content: center;"><img alt="Image represents a visual depiction of oversampling in a machine learning dataset.  The diagram shows two datasets: an 'Original dataset' and an 'Oversampled dataset'. The original dataset is divided into two rectangular areas representing the classes: a large, light-pink area labeled 'Negative (Majority class)' and a smaller, light-green area labeled 'Positive (Minority class)'.  Arrows originate from the 'Positive (Minority class)' section and point to the 'Oversampled dataset'. This dataset is also divided into two rectangular areas, one light-pink labeled 'Negative' and a larger light-green area containing four stacked rectangles, each labeled 'Positive'.  The arrows illustrate that the instances from the minority class ('Positive') in the original dataset have been replicated or augmented to increase their representation in the oversampled dataset, thereby balancing the class distribution and potentially improving the performance of a machine learning model trained on this balanced dataset." loading="lazy" width="549" height="216" decoding="async" data-nimg="1" sizes="(max-width: 840px) min(549px, 100vw), (max-width: 1200px) min(549px, 80vw), min(549px, 80vw)" srcset="https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-17-UFRX7TEH.png&amp;w=640&amp;q=75 640w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-17-UFRX7TEH.png&amp;w=750&amp;q=75 750w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-17-UFRX7TEH.png&amp;w=828&amp;q=75 828w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-17-UFRX7TEH.png&amp;w=1080&amp;q=75 1080w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-17-UFRX7TEH.png&amp;w=1200&amp;q=75 1200w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-17-UFRX7TEH.png&amp;w=1920&amp;q=75 1920w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-17-UFRX7TEH.png&amp;w=2048&amp;q=75 2048w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-17-UFRX7TEH.png&amp;w=3840&amp;q=75 3840w" src="https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-17-UFRX7TEH.png&amp;w=3840&amp;q=75" style="color: transparent;"></div><div style="display: flex; justify-content: center;"><figcaption class="py-1">Figure 1.17: Oversampling the minority class</figcaption></div></figure></center>
<center><figure class="py-1"><div style="display: flex; justify-content: center;"><img alt="Image represents a data undersampling technique for handling imbalanced datasets in machine learning.  The diagram shows an original dataset (enclosed by a dashed-line rectangle) composed of a large number of negative instances (represented by several horizontal pink rectangles labeled 'Negative (Majority class)') and a smaller number of positive instances (a single, smaller green rectangle labeled 'Positive (Minority class)').  Arrows originating from some of the negative instances in the original dataset point towards a smaller, undersampled dataset (another dashed-line rectangle). This undersampled dataset contains a reduced number of negative instances (a single pink rectangle labeled 'Negative') and all of the original positive instances (a single green rectangle labeled 'Positive'). The arrows illustrate the selection process where a subset of the negative instances is chosen to create a more balanced dataset for training a machine learning model, thereby mitigating the bias caused by the class imbalance in the original data." loading="lazy" width="537" height="217" decoding="async" data-nimg="1" sizes="(max-width: 840px) min(537px, 100vw), (max-width: 1200px) min(537px, 80vw), min(537px, 80vw)" srcset="https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-18-VUGQVHUY.png&amp;w=640&amp;q=75 640w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-18-VUGQVHUY.png&amp;w=750&amp;q=75 750w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-18-VUGQVHUY.png&amp;w=828&amp;q=75 828w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-18-VUGQVHUY.png&amp;w=1080&amp;q=75 1080w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-18-VUGQVHUY.png&amp;w=1200&amp;q=75 1200w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-18-VUGQVHUY.png&amp;w=1920&amp;q=75 1920w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-18-VUGQVHUY.png&amp;w=2048&amp;q=75 2048w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-18-VUGQVHUY.png&amp;w=3840&amp;q=75 3840w" src="https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-18-VUGQVHUY.png&amp;w=3840&amp;q=75" style="color: transparent;"></div><div style="display: flex; justify-content: center;"><figcaption class="py-1">Figure 1.18: Undersampling the majority class</figcaption></div></figure></center>
<h6 id="altering-the-loss-function">Altering the loss function</h6>
<p>This technique alters the loss function to make it more robust against class imbalance. The high-level idea is to give more weight to data points from the minority class. A higher weight in the loss function penalizes the model more when it makes a wrong prediction about a minority class. This forces the model to learn minority classes more effectively. Two commonly used loss functions to mitigate class imbalance are class-balanced loss [9] and focal loss [10][11].</p>
<h5 id="choosing-the-loss-function">Choosing the loss function</h5>
<p>Once the dataset is constructed, we need to choose a proper loss function to train the model. A loss function is a measurement of how accurate the model is at predicting an expected outcome. The loss function allows the optimization algorithm to update the model’s parameters during the training process in order to minimize the loss.</p>
<p>Designing a novel loss function is not easy. In ML interviews, you are usually expected to select a loss function from a list of existing loss functions based on how you framed the problem. Sometimes, you might need to make minor changes to the loss function to make it specific to the problem. We will provide more examples in later chapters.</p>
<h5 id="training-from-scratch-vs-fine-tuning">Training from scratch vs. fine-tuning</h5>
<p>One topic that might be useful to discuss briefly is training from scratch vs. fine-tuning. Fine-tuning means continuing to train the model on new data by making small changes to its learned parameters. This is a design decision you may need to discuss with the interviewer.</p>
<h5 id="distributed-training">Distributed training</h5>
<p>Training at scale becomes increasingly important because models grow bigger over time, and the size of the dataset also increases dramatically. Distributed training is commonly used to train the model, by dividing the work among multiple worker nodes. These worker nodes operate in parallel in order to speed up model training. There are two main types of distributed training: data parallelism [12] and model parallelism [13].</p>
<p>Depending on which task we are solving, employing distributed training may be necessary. In such cases, it’s important to discuss this topic with the interviewer. Note that distributed training is a generic topic you can talk about irrespective of the specific task.</p>
<h4 id="talking-points-2">Talking points</h4>
<p>Some talking points are listed below:</p>
<ul>
<li><strong>Model selection:</strong> Which ML models are suitable for the task, and what are their pros and cons. Here’s a list of topics to consider during model selection:
<ul>
<li>The time it takes to train</li>
<li>The amount of training data the model expects</li>
<li>The computing resources the model may need</li>
<li>Latency of the model at inference time</li>
<li>Can the model be deployed on a user’s device?</li>
<li>Model’s interpretability. Making a model more complex may increase its performance, but the results might be harder to interpret</li>
<li>Can we leverage continual training, or should we train from scratch?</li>
<li>How many parameters does the model have? How much memory is needed?</li>
<li>For neural networks, you might want to discuss typical architectures/blocks, such as ResNet or Transformer-based architectures. You can also discuss the choice of hyperparameters, such as the number of hidden layers, the number of neurons, activation functions, etc.</li>
</ul>
</li>
<li><strong>Dataset labels:</strong> How should we obtain the labels? Is the data annotated, and if so, how good are the annotations? If natural labels are available, how do we get them? How do we receive user feedback on the system? How long does it take to get natural labels?</li>
<li><strong>Model training.</strong>
<ul>
<li>What loss function should we choose? (e.g., Cross-entropy [14], MSE [15], MAE [16], Huber loss [17], etc.)</li>
<li>What regularization should we use? (e.g., L1 [19], L2 [18], Entropy Regularization [19], K-fold CV [20], or dropout [21])</li>
<li>What is backpropagation?</li>
<li>You may need to describe common optimization methods such as SGD [22], AdaGrad [23], Momentum [24], and RMSProp [25].</li>
<li>What activation functions do we want to use and why? (e.g., ELU [26], ReLU [27], Tanh [28], Sigmoid [29]).</li>
<li>How to handle an imbalanced dataset?</li>
<li>What is the bias/variance trade-off?</li>
<li>What are the possible causes of overfitting and underfitting? How to address them?</li>
</ul>
</li>
<li><strong>Continual learning:</strong> Do we want to train the model online with each new data point? Do we need to personalize the model to each user? How often do we retrain the model? Some models need to be retrained daily or weekly, and others monthly or yearly.</li>
</ul>
<h3 id="evaluation">Evaluation</h3>
<p>The next step after the model development is evaluation, which is the process of using different metrics to understand an ML model’s performance. In this section, we examine two evaluation methods, offline and online.</p>
<h4 id="offline-evaluation">Offline evaluation</h4>
<p>Offline evaluation refers to evaluating the performance of ML models during the model development phase. To evaluate a model, we usually first make predictions using the evaluation dataset. Next, we use various offline metrics to measure how close the predictions are to the ground truth values. Table 1.4 shows some of the commonly used metrics for different tasks.</p>
<div class="table-wrap" style="--table-min-width: 400px;"><table><thead><tr><th style="text-align: left;">Task</th><th style="text-align: left;">Offline metrics</th></tr></thead><tbody><tr><td style="text-align: left;">Classification</td><td style="text-align: left;">Precision, recall, F1 score, accuracy, ROC-AUC, PR-AUC, confusion matrix</td></tr><tr><td style="text-align: left;">Regression</td><td style="text-align: left;">MSE, MAE, RMSE</td></tr><tr><td style="text-align: left;">Ranking</td><td style="text-align: left;">Precision@k, recall@k, MRR, mAP, nDCG</td></tr><tr><td style="text-align: left;">Image generation</td><td style="text-align: left;">FID [30], Inception score [31]</td></tr><tr><td style="text-align: left;">Natural language processing</td><td style="text-align: left;">BLEU [32], METEOR [33], ROUGE [34], CIDEr [35], SPICE [36]</td></tr></tbody></table></div>
<p class="tableCaption">Table 1.4: Popular metrics in offline evaluation</p>
<p>During an interview, it’s important to identify suitable metrics for offline evaluation. This depends on the task at hand and how we have framed it. For example, if we try to solve a ranking problem, we might need to discuss ranking metrics and their trade-offs.</p>
<h4 id="online-evaluation">Online evaluation</h4>
<p>Online evaluation refers to the process of evaluating how the model performs in production after deployment. To measure the impact of the model, we need to define different metrics. Online metrics refer to those we use during an online evaluation and are usually tied to business objectives. Table 1.5 shows various metrics for different problems.</p>
<div class="table-wrap" style="--table-min-width: 400px;"><table><thead><tr><th style="text-align: left;">Problem</th><th style="text-align: left;">Online metrics</th></tr></thead><tbody><tr><td style="text-align: left;">Ad click prediction</td><td style="text-align: left;">Click-through rate, revenue lift, etc.</td></tr><tr><td style="text-align: left;">Harmful content detection</td><td style="text-align: left;">Prevalence, valid appeals, etc.</td></tr><tr><td style="text-align: left;">Video recommendation</td><td style="text-align: left;">Click-through rate, total watch time, number of completed videos, etc.</td></tr><tr><td style="text-align: left;">Friend recommendation</td><td style="text-align: left;">Number of requests sent per day, number of requests accepted per day, etc.</td></tr></tbody></table></div>
<p class="tableCaption">Table 1.5: Possible metrics in online evaluation</p>
<p>In practice, companies usually track many online metrics. At an interview, we need to select some of the most important ones to measure the impact of the system. As opposed to offline metrics, choosing online metrics Online metrics is subjective and depends upon product owners and business stakeholders.</p>
<p>In this step, the interviewer gauges your business sense. So, it is helpful to communicate your thought process and your reasons for choosing certain metrics.</p>
<h4 id="talking-points-3">Talking points</h4>
<p>Here are some talking points for the evaluation step:</p>
<ul>
<li><strong>Online metrics:</strong> Which metrics are important for measuring the effectiveness of the ML system online? How do these metrics relate to the business objective?</li>
<li><strong>Offline metrics:</strong> Which offline metrics are good at evaluating the model’s predictions during the development phase?</li>
<li><strong>Fairness and bias:</strong> Does the model have the potential for bias across different attributes such as age, gender, race, etc.? How would you fix this? What happens if someone with malicious intent gets access to your system?</li>
</ul>
<h3 id="deployment-and-serving">Deployment and Serving</h3>
<p>A natural next step after choosing the appropriate metrics for online and offline evaluations is to deploy the model to production and serve millions of users. Some important topics to cover include:</p>
<ul>
<li>Cloud vs. on-device deployment</li>
<li>Model compression</li>
<li>Testing in production</li>
<li>Prediction pipeline</li>
</ul>
<p>Let's take a look at each.</p>
<h4 id="cloud-vs-on-device-deployment">Cloud vs. on-device deployment</h4>
<p>Deploying a model on the cloud is different from deploying it on a mobile device. Table 1.6 summarizes the main differences between on-device deployment and cloud deployment.</p>
<div class="table-wrap" style="--table-min-width: 400px;"><table><thead><tr><td><strong></strong></td><td><strong>Cloud</strong></td><td><strong>On-device</strong></td></tr></thead><tbody><tr><td>Simplicity</td><td>✓ Simple to deploy and manage using cloud-based services</td><td>✘ Deploying models on a device is not straightforward</td></tr><tr><td>Cost</td><td>✘ Cloud costs might be high</td><td>✓ No cloud cost when computations are performed on-device</td></tr><tr><td>Network latency</td><td>✘ Network latency is present</td><td>✓ No network latency</td></tr><tr><td>Inference latency</td><td>✓ Usually faster inference due to more powerful machines</td><td>✘ ML models run slower</td></tr><tr><td>Hardware constraints</td><td>✓ Fewer constraints</td><td><p>✘ More constraints, such as limited memory, battery consumption, etc.</p></td></tr><tr><td>Privacy</td><td>✘ Less privacy as user data is transferred to the cloud</td><td>✓ More privacy since data never leaves the device</td></tr><tr><td>Dependency on internet connection</td><td><p>✘ Internet connection needed to send and receive data to the cloud</p></td><td>✓ No internet connection needed</td></tr></tbody></table></div>
<p class="tableCaption"><p>Table 1.6: Trade-offs between cloud and on-device deployment</p></p>
<h4 id="model-compression">Model compression</h4>
<p>Model compression refers to the process of making a model smaller. This is necessary
to reduce the inference latency and model size. Three techniques are commonly used to
compress models:</p>
<ul>
<li><strong>Knowledge distillation:</strong> The goal of knowledge distillation is to train a small model (student) to mimic a larger model (teacher).</li>
<li><strong>Pruning:</strong> Pruning refers to the process of finding the least useful parameters and setting them to zero. This leads to sparser models which can be stored more efficiently.</li>
<li><strong>Quantization:</strong> Model parameters are often represented with 32-bit floating numbers. In quantization, we use fewer bits to represent the parameters, which reduces the model’s size. Quantization can happen during training or post-training [37].</li>
</ul>
<p>To learn more about model compression, you are encouraged to read [38].</p>
<h4 id="test-in-production">Test in production</h4>
<p>The only way to ensure the model will perform well in production is to test it with real traffic. Commonly used techniques to test models include shadow deployment [39], A/B testing [40], canary release [41], interleaving experiments [42], bandits [43], etc.</p>
<p>To demonstrate that we understand how to test in production, it’s a good idea to mention at least one of these methods. Let’s briefly review shadow deployment and A/B testing.</p>
<h5 id="shadow-deployment">Shadow deployment</h5>
<p>In this method, we deploy the new model in parallel with the existing model. Each incoming request is routed to both models, but only the existing model's prediction is served to the user.</p>
<p>By shadow deploying the model, we minimize the risk of unreliable predictions until the newly developed model has been thoroughly tested. However, this is a costly approach that doubles the number of predictions.</p>
<center><figure class="py-1"><div style="display: flex; justify-content: center;"><div style="position: relative; width: 250px; height: 435px;"><img alt="Image represents a system for deploying a new machine learning (ML) model alongside an existing one.  A large circle encompassing twelve user icons labeled '100%' indicates that all users are being served.  A downward arrow labeled 'Request' connects this user group to a 'New ML system' box and an 'In-production ML system' box.  The 'New ML system' box receives requests and generates predictions, which are stored in a cylindrical database labeled 'Predictions'.  Simultaneously, an upward arrow labeled 'Response' connects the 'In-production ML system' box back to the user group, indicating that the existing system continues to provide responses.  The diagram illustrates a phased rollout, where the new system processes requests concurrently with the existing system, allowing for a controlled transition and monitoring of the new model's performance before fully replacing the in-production system." loading="lazy" width="250" height="435" decoding="async" data-nimg="1" sizes="(max-width: 840px) min(250px, 100vw), (max-width: 1200px) min(250px, 80vw), min(250px, 80vw)" srcset="https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-19-4ZFXRXH5.png&amp;w=640&amp;q=75 640w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-19-4ZFXRXH5.png&amp;w=750&amp;q=75 750w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-19-4ZFXRXH5.png&amp;w=828&amp;q=75 828w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-19-4ZFXRXH5.png&amp;w=1080&amp;q=75 1080w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-19-4ZFXRXH5.png&amp;w=1200&amp;q=75 1200w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-19-4ZFXRXH5.png&amp;w=1920&amp;q=75 1920w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-19-4ZFXRXH5.png&amp;w=2048&amp;q=75 2048w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-19-4ZFXRXH5.png&amp;w=3840&amp;q=75 3840w" src="https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-19-4ZFXRXH5.png&amp;w=3840&amp;q=75" style="color: transparent;"></div></div><div style="display: flex; justify-content: center;"><figcaption class="py-1">Figure 1.19: Shadow deployment</figcaption></div></figure></center>
<h5 id="ab-testing">A/B testing</h5>
<p>With this method, we deploy the new model in parallel with the existing model. A portion of the traffic is routed to the newly developed model, while the remaining requests are routed to the existing model.</p>
<p>In order to execute A/B testing correctly, there are two important factors to consider. First, the traffic routed to each model has to be random. Second, A/B tests should be run on a sufficient number of data points in order for the results to be legitimate.</p>
<center><figure class="py-1"><div style="display: flex; justify-content: center;"><div style="position: relative; width: 300px; height: 332px;"><img alt="Image represents a comparison of two machine learning systems: a new system and an in-production system.  Each system is depicted with an oval containing several icons representing users, with the percentage of users interacting with each system indicated (5% for the new system and 95% for the in-production system).  Arrows illustrate the flow of requests and responses between the users and the respective ML systems.  The new ML system receives requests from a small subset of users (5%), processes them, and sends back responses. Similarly, the in-production ML system handles requests from the vast majority of users (95%), processing their requests and returning responses.  The visual clearly shows the difference in user base scale between a newly deployed system and an established, widely used system." loading="lazy" width="300" height="332" decoding="async" data-nimg="1" sizes="(max-width: 840px) min(300px, 100vw), (max-width: 1200px) min(300px, 80vw), min(300px, 80vw)" srcset="https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-20-LHSFPEFI.png&amp;w=640&amp;q=75 640w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-20-LHSFPEFI.png&amp;w=750&amp;q=75 750w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-20-LHSFPEFI.png&amp;w=828&amp;q=75 828w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-20-LHSFPEFI.png&amp;w=1080&amp;q=75 1080w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-20-LHSFPEFI.png&amp;w=1200&amp;q=75 1200w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-20-LHSFPEFI.png&amp;w=1920&amp;q=75 1920w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-20-LHSFPEFI.png&amp;w=2048&amp;q=75 2048w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-20-LHSFPEFI.png&amp;w=3840&amp;q=75 3840w" src="https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-20-LHSFPEFI.png&amp;w=3840&amp;q=75" style="color: transparent;"></div></div><div style="display: flex; justify-content: center;"><figcaption class="py-1">Figure 1.20: A/B testing</figcaption></div></figure></center>
<h4 id="prediction-pipeline">Prediction pipeline</h4>
<p>To serve requests in production, we need a prediction pipeline. An important design decision to make is the choice between online prediction and batch prediction.</p>
<p><strong>Batch prediction.</strong> With batch prediction, the model makes predictions periodically. Because predictions are pre-computed, we don’t need to worry about how long it takes the model to generate predictions once they are pre-computed.</p>
<p>However, the batch prediction has two major drawbacks. First, the model becomes less responsive to the changing preferences of users. Secondly, batch prediction is only possible if we know in advance what needs to be pre-computed. For example, in a language translation system, we are not able to make translations in advance as it entirely depends on the user’s input.</p>
<center><figure class="py-1"><div style="display: flex; justify-content: center;"><img alt="Image represents a system architecture diagram illustrating a mobile application's interaction with a machine learning (ML) system.  A smartphone on the left initiates a 'Request' (labeled 3) to a database labeled 'Pre-computed predictions.' This database, depicted as a cylinder, stores pre-calculated predictions.  The request is then processed by the ML system (a rectangle in the center), which receives 'Features' (labeled 1) from a separate feature database (another cylinder on the right). The ML system generates 'Predictions' (labeled 2) and sends them back to the 'Pre-computed predictions' database. Finally, the smartphone receives a 'Response' (labeled 4) containing the predictions from the pre-computed predictions database.  The numbered labels (1-4) indicate the sequential flow of information within the system.  Arrows show the direction of data flow between the components." loading="lazy" width="707" height="144" decoding="async" data-nimg="1" sizes="(max-width: 840px) min(707px, 100vw), (max-width: 1200px) min(707px, 80vw), min(707px, 80vw)" srcset="https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-21-GVFZP25B.png&amp;w=640&amp;q=75 640w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-21-GVFZP25B.png&amp;w=750&amp;q=75 750w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-21-GVFZP25B.png&amp;w=828&amp;q=75 828w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-21-GVFZP25B.png&amp;w=1080&amp;q=75 1080w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-21-GVFZP25B.png&amp;w=1200&amp;q=75 1200w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-21-GVFZP25B.png&amp;w=1920&amp;q=75 1920w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-21-GVFZP25B.png&amp;w=2048&amp;q=75 2048w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-21-GVFZP25B.png&amp;w=3840&amp;q=75 3840w" src="https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-21-GVFZP25B.png&amp;w=3840&amp;q=75" style="color: transparent;"></div><div style="display: flex; justify-content: center;"><figcaption class="py-1">Figure 1.21: Batch prediction workflow</figcaption></div></figure></center>
<p><strong>Online prediction.</strong> In online prediction, predictions are generated and returned as soon as requests arrive. The main problem with online prediction is that the model might take too long to generate predictions.</p>
<center><figure class="py-1"><div style="display: flex; justify-content: center;"><img alt="Image represents a simplified architecture of a machine learning system interacting with a mobile application.  A smartphone is depicted on the left, representing the user interface.  A curved arrow labeled '1' and 'Request' shows a request originating from the smartphone and flowing into a rectangular box labeled 'ML system,' which represents the core machine learning model.  The ML system then receives data via a straight arrow labeled '2' from a cylindrical database labeled 'Features,' indicating that the model uses features stored in this database for its predictions.  Finally, a curved arrow labeled '3' and 'Response' shows the ML system sending a response back to the smartphone, completing the request-response cycle.  The numbered arrows (1, 2, 3) visually represent the flow of information and the sequence of operations within the system." loading="lazy" width="500" height="144" decoding="async" data-nimg="1" sizes="(max-width: 840px) min(500px, 100vw), (max-width: 1200px) min(500px, 80vw), min(500px, 80vw)" srcset="https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-22-AVMRKVSN.png&amp;w=640&amp;q=75 640w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-22-AVMRKVSN.png&amp;w=750&amp;q=75 750w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-22-AVMRKVSN.png&amp;w=828&amp;q=75 828w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-22-AVMRKVSN.png&amp;w=1080&amp;q=75 1080w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-22-AVMRKVSN.png&amp;w=1200&amp;q=75 1200w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-22-AVMRKVSN.png&amp;w=1920&amp;q=75 1920w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-22-AVMRKVSN.png&amp;w=2048&amp;q=75 2048w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-22-AVMRKVSN.png&amp;w=3840&amp;q=75 3840w" src="https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-22-AVMRKVSN.png&amp;w=3840&amp;q=75" style="color: transparent;"></div><div style="display: flex; justify-content: center;"><figcaption class="py-1">Figure 1.22: Online prediction workflow</figcaption></div></figure></center>
<p>This choice of batch prediction or online prediction is mainly driven by product requirements. Online prediction is generally preferred in situations where we do not know what needs to be computed in advance. Batch prediction is ideal when the system processes a high volume of data, and the results are not needed in real time.</p>
<p>As previously discussed, ML system development involves more than just ML modeling. Proposing an overall ML system design in an interview demonstrates a deep understanding of how different components work together as a whole. Interviewers often take this as a critical signal.</p>
<p>Figure 1.23 shows an example of the ML system design for a personalized news feed system. We will examine it in more depth in Chapter 10.</p>
<center><figure class="py-1"><div style="display: flex; justify-content: center;"><img alt="Image represents a machine learning system for personalized feed generation.  A user initiates the process.  Their request flows into a 'Prediction pipeline' which begins with a 'Retrieval service'. This service retrieves relevant posts based on the user's profile and preferences. The retrieved posts then enter a 'Ranking service', which uses an 'ML model' to score them based on predicted relevance.  The 'Ranking service' receives input from both an 'Online feature computation' (likely real-time features) and a 'Feature store' (containing pre-computed features). The 'Feature store' is populated by a 'Batch feature computation' process that processes a 'Stream of new data and interactions' stored in a 'Data store'.  The ranked posts are further refined by a 'Re-ranking service', potentially incorporating additional contextual information. Finally, the top 'k' posts, forming a 'Personalized feed for the user', are presented to the user, each represented as 'Post 1', 'Post 2', ..., 'Post k'.  The entire system is structured as two main pipelines: a 'Prediction pipeline' handling online prediction and a 'Data preparation pipeline' responsible for feature engineering and data storage." loading="lazy" width="755" height="395" decoding="async" data-nimg="1" sizes="(max-width: 840px) min(755px, 100vw), (max-width: 1200px) min(755px, 80vw), min(755px, 80vw)" srcset="https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-23-NQHGT6VS.png&amp;w=640&amp;q=75 640w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-23-NQHGT6VS.png&amp;w=750&amp;q=75 750w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-23-NQHGT6VS.png&amp;w=828&amp;q=75 828w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-23-NQHGT6VS.png&amp;w=1080&amp;q=75 1080w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-23-NQHGT6VS.png&amp;w=1200&amp;q=75 1200w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-23-NQHGT6VS.png&amp;w=1920&amp;q=75 1920w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-23-NQHGT6VS.png&amp;w=2048&amp;q=75 2048w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-23-NQHGT6VS.png&amp;w=3840&amp;q=75 3840w" src="https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-23-NQHGT6VS.png&amp;w=3840&amp;q=75" style="color: transparent;"></div><div style="display: flex; justify-content: center;"><figcaption class="py-1">Figure 1.23: ML system design for a personalized news feed system</figcaption></div></figure></center>
<h4 id="talking-points-4">Talking points</h4>
<ul>
<li>Is model compression needed? What are some commonly used compression techniques?</li>
<li>Is online prediction or batch prediction more suitable? What are the trade-offs?</li>
<li>Is real-time access to features possible? What are the challenges?</li>
<li>How should we test the deployed model in production?</li>
<li>An ML system consists of various components working together to serve requests. What are the responsibilities of each component in the proposed design?</li>
<li>What technologies should we use to ensure that serving is fast and scalable?</li>
</ul>
<h3 id="monitoring">Monitoring</h3>
<p>Monitoring refers to the task of tracking, measuring, and logging different metrics. An ML system in production can fail for many reasons. Monitoring helps to detect system failures when they occur, so they can be fixed as quickly as possible.</p>
<p>Monitoring is an important topic to discuss in ML system design interviews. Two primary areas you may want to discuss are:</p>
<ul>
<li>Why a system fails in production</li>
<li>What to monitor</li>
</ul>
<h4 id="why-a-system-fails-in-production">Why a system fails in production</h4>
<p>There are various reasons why an ML system may fail after it is deployed to production. One of the most common reasons is data distribution shift.</p>
<p>Data distribution shift refers to the scenario in which the data a model encounters in production differs from that it encountered during training. Figure 1.24 shows an example where the training data comprised images of cups seen from the front view, but at serving time, an image of a cup at a different angle is passed to the ML model.</p>
<center><figure class="py-1"><div style="display: flex; justify-content: center;"><img alt="Image represents a visual depiction of a machine learning model's training and serving stages.  The left side, labeled 'Training: 61%', displays a 2x2 grid of four diverse mug images used as training data. These mugs vary in color, design, and style; one is plain white, another features a cat design, a third is yellow with speckles, and the fourth showcases abstract colorful patterns.  The right side, labeled 'Serving: 25%', shows another 2x2 grid of four different mug images representing the model's output or predictions.  These include a metal mug with text, a mug filled with coffee, a mug lying on its side, and an empty espresso cup with a saucer and spoon. A light green arrow points from the 'Training' grid to the 'Serving' grid, indicating the flow of information from the training data to the model's predictions. The percentages suggest that 61% of the data is used for training, while only 25% is currently being used for serving, implying a potential imbalance or further optimization needed in the model's deployment." loading="lazy" width="388" height="184" decoding="async" data-nimg="1" sizes="(max-width: 840px) min(388px, 100vw), (max-width: 1200px) min(388px, 80vw), min(388px, 80vw)" srcset="https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-24-ZF52NGYY.png&amp;w=640&amp;q=75 640w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-24-ZF52NGYY.png&amp;w=750&amp;q=75 750w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-24-ZF52NGYY.png&amp;w=828&amp;q=75 828w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-24-ZF52NGYY.png&amp;w=1080&amp;q=75 1080w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-24-ZF52NGYY.png&amp;w=1200&amp;q=75 1200w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-24-ZF52NGYY.png&amp;w=1920&amp;q=75 1920w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-24-ZF52NGYY.png&amp;w=2048&amp;q=75 2048w, https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-24-ZF52NGYY.png&amp;w=3840&amp;q=75 3840w" src="https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fmachine-learning-system-design-interview%2Fintroduction-and-overview%2Fch1-24-ZF52NGYY.png&amp;w=3840&amp;q=75" style="color: transparent;"></div><div style="display: flex; justify-content: center;"><figcaption class="py-1">Figure 1.24: Data distribution shift</figcaption></div></figure></center>
<p>Data distribution in the real world constantly changes. In other words, the data used for training is likely to become less relevant as time passes. This leads to a stale model with deteriorating performance over time. Therefore, we should continuously monitor the system to detect this problem. Two common approaches for dealing with data distribution shifts are:</p>
<ul>
<li>Train on large datasets. A big enough training dataset enables the model to learn a comprehensive distribution, so any data points encountered in production likely come from this learned distribution.</li>
<li>Regularly retrain the model using labeled data from the new distribution.</li>
</ul>
<h4 id="what-to-monitor">What to monitor</h4>
<p>This is a broad topic, and here we focus on post-production monitoring techniques. Our goal is to detect failures and identify shifts in the ML system. Broadly speaking, we can categorize monitoring techniques in ML systems into two buckets: operation-related and ML-specific metrics.</p>
<p><strong>Operation-related metrics:</strong> Those metrics ensure the system is up and running. They include average serving times, throughput, the number of prediction requests, CPU/GPU utilization, etc.</p>
<p><strong>ML-specific metrics:</strong></p>
<ul>
<li>Monitoring inputs/outputs. Models are only as good as the data they consume, so monitoring the model’s input and outputs is vital.</li>
<li>Drifts. Inputs to the system and the model’s outputs are monitored to detect changes in their underlying distribution.</li>
<li>Model accuracy. For example, we expect the accuracy to be within a specific range.</li>
<li>Model versions. Monitor which version of the model is deployed.</li>
</ul>
<h3 id="infrastructure">Infrastructure</h3>
<p>Infrastructure is the foundation for training, deploying, and maintaining ML systems.</p>
<p>In many ML interviews, you won’t be asked infrastructure-related questions. However, some ML roles, such as DevOps and MLOps may require infrastructure knowledge. So, it’s important to be clear about the interviewer’s expectations for this topic.</p>
<p>Infrastructure is a very broad subject and cannot be summarized in just a few lines. If you’re interested in learning more about ML infrastructure, refer to [44][45][46].</p>
<h3 id="summary">Summary</h3>
<p>In this chapter, we proposed a framework for an ML system design interview. While many topics discussed in this chapter are task-specific, some are generic and applicable to a wide range of tasks. Throughout this book, we only focus on unique talking points specific to the problem at hand, in order to avoid repetition. For example, topics related to deployment, monitoring, and infrastructure are often similar, regardless of the task. Therefore, we do not repeat generic topics in later chapters, but you are usually expected to talk about them during an interview.</p>
<p>Finally, no engineer can be an expert in every aspect of the ML lifecycle. Some engineers specialize in deployment and production, while others specialize in model development. Some companies may not care about infrastructure, while others may focus heavily on monitoring and infrastructure. Data science roles generally require more data engineering, while applied ML roles focus more on model development and productionization. Depending on the role and the interviewer's preference, some steps may be discussed in more detail, while others may be discussed briefly or even skipped. In general, a candidate should seek to drive the conversation, while being ready to go with the interviewer’s flow, if they raise a question.</p>
<p>Now you understand these fundamentals, we’re ready to tackle some of the most common ML system design interview questions.</p>
<h3 id="references">References</h3>
<ol>
<li>Data warehouse. <a href="https://cloud.google.com/learn/what-is-a-data-warehouse" target="_blank" rel="noopener noreferrer">https://cloud.google.com/learn/what-is-a-data-warehouse</a>.</li>
<li>Bagging technique in ensemble learning. <a href="https://en.wikipedia.org/wiki/Bootstrap_aggregating" target="_blank" rel="noopener noreferrer">https://en.wikipedia.org/wiki/Bootstrap_aggregating</a>.</li>
<li>Boosting technique in ensemble learning. <a href="https://aws.amazon.com/what-is/boosting/" target="_blank" rel="noopener noreferrer">https://aws.amazon.com/what-is/boosting/</a>.</li>
<li>Stacking technique in ensemble learning. <a href="https://machinelearningmastery.com/stacking-ensemble-machine-learning-with-python/" target="_blank" rel="noopener noreferrer">https://machinelearningmastery.com/stacking-ensemble-machine-learning-with-python/</a>.</li>
<li>Interpretability in Machine Mearning. <a href="https://blog.ml.cmu.edu/2020/08/31/6-interpretability/" target="_blank" rel="noopener noreferrer">https://blog.ml.cmu.edu/2020/08/31/6-interpretability/</a>.</li>
<li>Traditional machine learning algorithms. <a href="https://machinelearningmastery.com/a-tour-of-machine-learning-algorithms/" target="_blank" rel="noopener noreferrer">https://machinelearningmastery.com/a-tour-of-machine-learning-algorithms/</a>.</li>
<li>Sampling strategies. <a href="https://www.scribbr.com/methodology/sampling-methods/" target="_blank" rel="noopener noreferrer">https://www.scribbr.com/methodology/sampling-methods/</a>.</li>
<li>Data splitting techniques. <a href="https://machinelearningmastery.com/train-test-split-for-evaluating-machine-learning-algorithms/" target="_blank" rel="noopener noreferrer">https://machinelearningmastery.com/train-test-split-for-evaluating-machine-learning-algorithms/</a>.</li>
<li>Class-balanced loss. <a href="https://arxiv.org/pdf/1901.05555.pdf" target="_blank" rel="noopener noreferrer">https://arxiv.org/pdf/1901.05555.pdf</a>.</li>
<li>Focal loss paper. <a href="https://arxiv.org/pdf/1708.02002.pdf" target="_blank" rel="noopener noreferrer">https://arxiv.org/pdf/1708.02002.pdf</a>.</li>
<li>Focal loss. <a href="https://medium.com/swlh/focal-loss-an-efficient-way-of-handling-class-imbalance-4855ae1db4cb" target="_blank" rel="noopener noreferrer">https://medium.com/swlh/focal-loss-an-efficient-way-of-handling-class-imbalance-4855ae1db4cb</a>.</li>
<li>Data parallelism. <a href="https://www.telesens.co/2017/12/25/understanding-data-parallelism-in-machine-learning/" target="_blank" rel="noopener noreferrer">https://www.telesens.co/2017/12/25/understanding-data-parallelism-in-machine-learning/</a>.</li>
<li>Model parallelism. <a href="https://docs.aws.amazon.com/sagemaker/latest/dg/model-parallel-intro.html" target="_blank" rel="noopener noreferrer">https://docs.aws.amazon.com/sagemaker/latest/dg/model-parallel-intro.html</a>.</li>
<li>Cross entropy loss. <a href="https://en.wikipedia.org/wiki/Cross_entropy" target="_blank" rel="noopener noreferrer">https://en.wikipedia.org/wiki/Cross_entropy</a>.</li>
<li>Mean squared error loss. <a href="https://en.wikipedia.org/wiki/Mean_squared_error" target="_blank" rel="noopener noreferrer">https://en.wikipedia.org/wiki/Mean_squared_error</a>.</li>
<li>Mean absolute error loss. <a href="https://en.wikipedia.org/wiki/Mean_absolute_error" target="_blank" rel="noopener noreferrer">https://en.wikipedia.org/wiki/Mean_absolute_error</a>.</li>
<li>Huber loss. <a href="https://en.wikipedia.org/wiki/Huber_loss" target="_blank" rel="noopener noreferrer">https://en.wikipedia.org/wiki/Huber_loss</a>.</li>
<li>L1 and l2 regularization. <a href="https://www.analyticssteps.com/blogs/l2-and-l1-regularization-machine-learning" target="_blank" rel="noopener noreferrer">https://www.analyticssteps.com/blogs/l2-and-l1-regularization-machine-learning</a>.</li>
<li>Entropy regularization. <a href="https://paperswithcode.com/method/entropy-regularization" target="_blank" rel="noopener noreferrer">https://paperswithcode.com/method/entropy-regularization</a>.</li>
<li>K-fold cross validation. <a href="https://en.wikipedia.org/wiki/Cross-validation_(statistics)" target="_blank" rel="noopener noreferrer">https://en.wikipedia.org/wiki/Cross-validation_(statistics)</a>.</li>
<li>Dropout paper. <a href="https://jmlr.org/papers/volume15/srivastava14a/srivastava14a.pdf" target="_blank" rel="noopener noreferrer">https://jmlr.org/papers/volume15/srivastava14a/srivastava14a.pdf</a>.</li>
<li>Stochastic gradient descent. <a href="https://en.wikipedia.org/wiki/Stochastic_gradient_descent" target="_blank" rel="noopener noreferrer">https://en.wikipedia.org/wiki/Stochastic_gradient_descent</a>.</li>
<li>AdaGrad optimization algorithm. <a href="https://optimization.cbe.cornell.edu/index.php?title=AdaGrad" target="_blank" rel="noopener noreferrer">https://optimization.cbe.cornell.edu/index.php?title=AdaGrad</a>.</li>
<li>Momentum optimization algorithm. <a href="https://optimization.cbe.cornell.edu/index.php?title=Momentum" target="_blank" rel="noopener noreferrer">https://optimization.cbe.cornell.edu/index.php?title=Momentum</a>.</li>
<li>RMSProp optimization algorithm. <a href="https://optimization.cbe.cornell.edu/index.php?title=RMSProp" target="_blank" rel="noopener noreferrer">https://optimization.cbe.cornell.edu/index.php?title=RMSProp</a>.</li>
<li>ELU activation function. <a href="https://ml-cheatsheet.readthedocs.io/en/latest/activation_functions.html#elu" target="_blank" rel="noopener noreferrer">https://ml-cheatsheet.readthedocs.io/en/latest/activation_functions.html#elu</a>.</li>
<li>ReLU activation function. <a href="https://ml-cheatsheet.readthedocs.io/en/latest/activation_functions.html#relu" target="_blank" rel="noopener noreferrer">https://ml-cheatsheet.readthedocs.io/en/latest/activation_functions.html#relu</a>.</li>
<li>Tanh activation function. <a href="https://ml-cheatsheet.readthedocs.io/en/latest/activation_functions.html#tanh" target="_blank" rel="noopener noreferrer">https://ml-cheatsheet.readthedocs.io/en/latest/activation_functions.html#tanh</a>.</li>
<li>Sigmoid activation function. <a href="https://ml-cheatsheet.readthedocs.io/en/latest/activation_functions.html#softmax" target="_blank" rel="noopener noreferrer">https://ml-cheatsheet.readthedocs.io/en/latest/activation_functions.html#softmax</a>.</li>
<li>FID score. <a href="https://en.wikipedia.org/wiki/Fr%C3%A9chet_inception_distance" target="_blank" rel="noopener noreferrer">https://en.wikipedia.org/wiki/Fr%C3%A9chet_inception_distance</a>.</li>
<li>Inception score. <a href="https://en.wikipedia.org/wiki/Inception_score" target="_blank" rel="noopener noreferrer">https://en.wikipedia.org/wiki/Inception_score</a>.</li>
<li>BLEU metrics. <a href="https://en.wikipedia.org/wiki/BLEU" target="_blank" rel="noopener noreferrer">https://en.wikipedia.org/wiki/BLEU</a>.</li>
<li>METEOR metrics. <a href="https://en.wikipedia.org/wiki/METEOR" target="_blank" rel="noopener noreferrer">https://en.wikipedia.org/wiki/METEOR</a>.</li>
<li>ROUGE score. <a href="https://en.wikipedia.org/wiki/ROUGE_(metric)" target="_blank" rel="noopener noreferrer">https://en.wikipedia.org/wiki/ROUGE_(metric)</a>.</li>
<li>CIDEr score. <a href="https://arxiv.org/pdf/1411.5726.pdf" target="_blank" rel="noopener noreferrer">https://arxiv.org/pdf/1411.5726.pdf</a>.</li>
<li>SPICE score. <a href="https://arxiv.org/pdf/1607.08822.pdf" target="_blank" rel="noopener noreferrer">https://arxiv.org/pdf/1607.08822.pdf</a>.</li>
<li>Quantization-aware training. <a href="https://pytorch.org/docs/stable/quantization.html" target="_blank" rel="noopener noreferrer">https://pytorch.org/docs/stable/quantization.html</a>.</li>
<li>Model compression survey. <a href="https://arxiv.org/pdf/1710.09282.pdf" target="_blank" rel="noopener noreferrer">https://arxiv.org/pdf/1710.09282.pdf</a>.</li>
<li>Shadow deployment. <a href="https://christophergs.com/machine%20learning/2019/03/30/deploying-machine-learning-applications-in-shadow-mode/" target="_blank" rel="noopener noreferrer">https://christophergs.com/machine%20learning/2019/03/30/deploying-machine-learning-applications-in-shadow-mode/</a>.</li>
<li>A/B testing. <a href="https://en.wikipedia.org/wiki/A/B_testing" target="_blank" rel="noopener noreferrer">https://en.wikipedia.org/wiki/A/B_testing</a>.</li>
<li>Canary release. <a href="https://blog.getambassador.io/cloud-native-patterns-canary-release-1cb8f82d371a" target="_blank" rel="noopener noreferrer">https://blog.getambassador.io/cloud-native-patterns-canary-release-1cb8f82d371a</a>.</li>
<li>Interleaving experiment. <a href="https://netflixtechblog.com/interleaving-in-online-experiments-at-netflix-a04ee392ec55" target="_blank" rel="noopener noreferrer">https://netflixtechblog.com/interleaving-in-online-experiments-at-netflix-a04ee392ec55</a>.</li>
<li>Multi-armed bandit. <a href="https://vwo.com/blog/multi-armed-bandit-algorithm/" target="_blank" rel="noopener noreferrer">https://vwo.com/blog/multi-armed-bandit-algorithm/</a>.</li>
<li>ML infrastructure. <a href="https://www.run.ai/guides/machine-learning-engineering/machine-learning-infrastructure" target="_blank" rel="noopener noreferrer">https://www.run.ai/guides/machine-learning-engineering/machine-learning-infrastructure</a>.</li>
<li>Interpretability in ML. <a href="https://fullstackdeeplearning.com/spring2021/lecture-6/" target="_blank" rel="noopener noreferrer">https://fullstackdeeplearning.com/spring2021/lecture-6/</a>.</li>
<li>Chip Huyen. <em>Designing Machine Learning Systems: An Iterative Process for Production-Ready Application</em>. ” O’Reilly Media, Inc.”, 2022.</li>
</ol>
        </article>
    </main>

    <div class="nav">
        <a href="../machine-learning-system-design-interview.html">← Course Contents</a>
        
        <a href="visual-search-system.html">Next →</a>
    </div>

    <footer class="metadata">
        <p>Scraped on 10/10/2025</p>
    </footer>
</body>
</html>